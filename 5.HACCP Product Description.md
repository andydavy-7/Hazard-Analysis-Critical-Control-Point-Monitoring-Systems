# HACCP Compliance Platform - Product Description
## Comprehensive Product Definition

**Version:** 1.0
**Date:** December 2024
**Status:** Product Definition
**Document Type:** Detailed Product Specification

---

## Executive Summary

### Product Vision

The **HACCP Compliance Platform** is an implementation-free, mobile-first compliance solution that transforms HACCP (Hazard Analysis Critical Control Point) from a regulatory burden into a competitive advantage. Unlike enterprise QMS platforms requiring 6-12 month implementations, our platform delivers compliance in 24 hours through AI-powered plan generation, consumer-grade mobile UX, and plug-and-play IoT integration.

**Core Value Proposition:**
> "From signup to audit-ready in 24 hours, not 6 months. HACCP compliance for businesses that can't afford enterprise complexity."

### Target Markets

**Primary Markets:**
1. **Food Manufacturing** - Small to mid-size manufacturers (10-500 employees)
2. **Hospitality/Restaurant** - Multi-location chains (5-50 locations)
3. **Pharmaceuticals** - Contract manufacturers (CMOs), supplement makers

**Market Positioning:**
- **vs. SafetyChain (Enterprise):** "Enterprise features, SMB price and speed"
- **vs. FoodDocs (SMB):** "Same affordability, better reliability and features"
- **vs. Manual/Spreadsheets:** "Digital compliance without implementation hell"

### Deployment Models

**1. Cloud SaaS (Primary)**
- Multi-tenant architecture
- Hosted on AWS/Azure
- 99.9% uptime SLA
- Automatic updates (no downtime)

**2. Hybrid (Optional - Enterprise)**
- Core platform in cloud
- On-premise data storage for sensitive records
- Available for pharma 21 CFR Part 11 requirements

**3. Mobile-First Architecture**
- Native iOS and Android apps
- Offline-first design (works without internet)
- Background sync when connectivity restored
- Progressive Web App (PWA) for desktop

### Core Modules

The platform comprises **7 integrated modules** organized around the HACCP compliance lifecycle:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   PLATFORM ARCHITECTURE                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  MODULE 1: HACCP Plan Management                           â”‚
â”‚  Create, maintain, and version HACCP plans with AI         â”‚
â”‚                                                             â”‚
â”‚  MODULE 2: Daily Monitoring & Data Capture                 â”‚
â”‚  Mobile-first data collection with offline capability      â”‚
â”‚                                                             â”‚
â”‚  MODULE 3: Corrective Action Management                    â”‚
â”‚  Guided workflows for violations and incidents             â”‚
â”‚                                                             â”‚
â”‚  MODULE 4: Audit & Reporting                               â”‚
â”‚  One-click audit report generation and compliance tracking â”‚
â”‚                                                             â”‚
â”‚  MODULE 5: Multi-Location Management                       â”‚
â”‚  Centralized visibility across facilities and franchises   â”‚
â”‚                                                             â”‚
â”‚  MODULE 6: Integration & IoT                               â”‚
â”‚  Connect sensors, ERPs, and third-party systems            â”‚
â”‚                                                             â”‚
â”‚  MODULE 7: Administration & Settings                       â”‚
â”‚  User management, roles, permissions, and configuration    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Pricing Tiers

| Tier | Target | Monthly Price | Core Features |
|------|--------|--------------|---------------|
| **Starter** | Single location, 1-10 employees | $99 | 1 facility, 10 users, basic features |
| **Professional** | Single location, growth stage | $199 | Unlimited users, IoT, integrations |
| **Multi-Site** | 2-10 locations | $149/location | Centralized dashboard, comparisons |
| **Enterprise** | 11+ locations or pharma | Custom | Volume discounts, pre-validation, API |

---

## Product Architecture Overview

### System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CLIENT LAYER                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ iOS App      â”‚  â”‚ Android App  â”‚  â”‚ Web App      â”‚     â”‚
â”‚  â”‚ (Swift)      â”‚  â”‚ (Kotlin)     â”‚  â”‚ (React)      â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                             â”‚
â”‚  Features:                                                 â”‚
â”‚  â€¢ Offline-first data storage (SQLite)                     â”‚
â”‚  â€¢ Background sync via REST API                            â”‚
â”‚  â€¢ Push notifications (FCM / APNS)                         â”‚
â”‚  â€¢ QR code scanning (camera integration)                   â”‚
â”‚  â€¢ Photo/video capture                                     â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    API GATEWAY LAYER                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  REST API (Node.js / Express)                              â”‚
â”‚  â€¢ Authentication (JWT tokens, refresh tokens)             â”‚
â”‚  â€¢ Rate limiting and throttling                            â”‚
â”‚  â€¢ Request validation and sanitization                     â”‚
â”‚  â€¢ API versioning (v1, v2)                                 â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 APPLICATION SERVICES LAYER                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ HACCP Plan Service  â”‚    â”‚ Monitoring Service  â”‚       â”‚
â”‚  â”‚ â€¢ Plan generation   â”‚    â”‚ â€¢ Data capture      â”‚       â”‚
â”‚  â”‚ â€¢ AI assistance     â”‚    â”‚ â€¢ Validation        â”‚       â”‚
â”‚  â”‚ â€¢ Versioning        â”‚    â”‚ â€¢ Alerting          â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ Corrective Action   â”‚    â”‚ Reporting Service   â”‚       â”‚
â”‚  â”‚ â€¢ Workflow engine   â”‚    â”‚ â€¢ PDF generation    â”‚       â”‚
â”‚  â”‚ â€¢ Notifications     â”‚    â”‚ â€¢ Analytics         â”‚       â”‚
â”‚  â”‚ â€¢ Approvals         â”‚    â”‚ â€¢ Export            â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ Integration Service â”‚    â”‚ IoT Service         â”‚       â”‚
â”‚  â”‚ â€¢ ERP connectors    â”‚    â”‚ â€¢ Sensor data       â”‚       â”‚
â”‚  â”‚ â€¢ POS connectors    â”‚    â”‚ â€¢ Device mgmt       â”‚       â”‚
â”‚  â”‚ â€¢ Webhooks          â”‚    â”‚ â€¢ Real-time stream  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     DATA LAYER                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ PostgreSQL          â”‚    â”‚ MongoDB             â”‚       â”‚
â”‚  â”‚ â€¢ Transactional dataâ”‚    â”‚ â€¢ Document storage  â”‚       â”‚
â”‚  â”‚ â€¢ Audit logs        â”‚    â”‚ â€¢ HACCP plans       â”‚       â”‚
â”‚  â”‚ â€¢ User data         â”‚    â”‚ â€¢ Templates         â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ Redis Cache         â”‚    â”‚ S3 Object Storage   â”‚       â”‚
â”‚  â”‚ â€¢ Session data      â”‚    â”‚ â€¢ Photos            â”‚       â”‚
â”‚  â”‚ â€¢ Real-time data    â”‚    â”‚ â€¢ Videos            â”‚       â”‚
â”‚  â”‚ â€¢ Queue             â”‚    â”‚ â€¢ PDFs              â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 INFRASTRUCTURE LAYER                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  AWS / Azure Cloud Infrastructure                          â”‚
â”‚  â€¢ Auto-scaling (horizontal pod scaling)                   â”‚
â”‚  â€¢ Load balancing                                          â”‚
â”‚  â€¢ CDN for global performance                              â”‚
â”‚  â€¢ Backup and disaster recovery                            â”‚
â”‚  â€¢ Security (WAF, DDoS protection)                         â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Data Flow Architecture

```
DAILY MONITORING FLOW (Offline-First):

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. USER TRIGGERS MONITORING TASK                           â”‚
â”‚    â€¢ Push notification or manual open                      â”‚
â”‚    â€¢ User opens mobile app                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. LOCAL DATA CAPTURE (Offline-First)                      â”‚
â”‚    â€¢ App checks: Is data entry required?                   â”‚
â”‚    â€¢ User scans QR code (identifies CCP/location)          â”‚
â”‚    â€¢ User enters measurement (temp, pH, time)              â”‚
â”‚    â€¢ User takes photo evidence                             â”‚
â”‚    â€¢ App validates critical limits (local logic)           â”‚
â”‚    â€¢ Data stored in local SQLite database                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. BACKGROUND SYNC (When Connectivity Available)           â”‚
â”‚    â€¢ App detects WiFi/cellular connection                  â”‚
â”‚    â€¢ Queue manager checks for unsynchronized records       â”‚
â”‚    â€¢ POST request to /api/v1/monitoring/sync               â”‚
â”‚    â€¢ Batch upload (multiple records at once)               â”‚
â”‚    â€¢ Server validates, persists to PostgreSQL              â”‚
â”‚    â€¢ Photos uploaded to S3                                 â”‚
â”‚    â€¢ Local records marked as synced                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. REAL-TIME ALERTING (Server-Side)                        â”‚
â”‚    â€¢ Server evaluates critical limits                      â”‚
â”‚    â€¢ If violation detected:                                â”‚
â”‚      - Create alert record in PostgreSQL                   â”‚
â”‚      - Publish to real-time notification service           â”‚
â”‚      - Send push notification to managers                  â”‚
â”‚      - Send SMS/email based on severity                    â”‚
â”‚      - Update dashboard (real-time via WebSocket)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. DASHBOARD UPDATE                                        â”‚
â”‚    â€¢ Manager dashboard auto-refreshes (WebSocket)          â”‚
â”‚    â€¢ Compliance metrics updated                            â”‚
â”‚    â€¢ Trend charts recalculated                             â”‚
â”‚    â€¢ Executive view updated (if multi-location)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Module 1: HACCP Plan Management

### 1.1 Module Overview

**Purpose:** Enable users to create, maintain, and version HACCP plans through AI-powered guidance, eliminating the need for consultants or weeks of manual work.

**Target Users:**
- Quality Assurance Managers (create and maintain plans)
- Compliance Officers (review and approve plans)
- Facility Managers (view and understand plans)

**Key Outcomes:**
- Compliant HACCP plan created in <1 hour (vs. 2-6 weeks manual)
- 100% regulatory compliance (FDA, FSMA, GFSI standards)
- Version control and audit trail for all plan changes
- Industry-specific templates (50+ pre-built plans)

---

### 1.2 Features & Operations

#### Feature F1.1: AI-Powered HACCP Plan Builder

**Description:**
Interactive questionnaire that guides users through the 12 steps of HACCP plan development, using AI to suggest Critical Control Points (CCPs), critical limits, monitoring procedures, and corrective actions based on industry best practices and regulatory requirements. The AI analyzes user inputs (product type, process flow, facility characteristics) and generates a compliant HACCP plan in under 1 hour.

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| **Initiate Plan Creation** | User starts a new HACCP plan for a product/process | Clicks "Create New HACCP Plan", selects industry (Food Mfg, Pharma, Restaurant) | Opens AI-guided questionnaire wizard; loads industry-specific template |
| **Define Product & Process** | User provides product details and process flow | Answers: Product name, ingredients, process steps (mix, cook, cool, package) | AI maps process flow diagram; identifies potential hazard points |
| **Hazard Analysis** | System suggests biological, chemical, physical hazards | Reviews AI-suggested hazards for each process step; adds/removes/edits | AI cross-references FDA hazard database; suggests likelihood and severity |
| **Identify CCPs** | AI recommends Critical Control Points using decision tree | Reviews suggested CCPs (e.g., "Cooking" for kill step); approves or adjusts | System highlights CCPs in process flow; explains rationale per FDA guidelines |
| **Set Critical Limits** | AI suggests science-based critical limits | Reviews limits (e.g., "Internal temp â‰¥165Â°F for 15 sec"); adjusts if needed | Validates limits against FDA/USDA standards; flags if out of range |
| **Define Monitoring** | AI suggests monitoring frequency, methods, and responsible roles | Specifies: Who, What, When, Where, How for each CCP | Generates monitoring task templates for Module 2 |
| **Establish Corrective Actions** | AI provides pre-written corrective action procedures | Reviews and customizes corrective action steps | Links corrective actions to Module 3 workflows |
| **Verification & Validation** | System generates verification schedule (audits, testing) | Reviews verification frequency; assigns responsible person | Creates verification task calendar |
| **Record-Keeping Setup** | AI creates record templates for monitoring logs | Reviews and approves record formats | Auto-generates forms for floor staff (Module 2) |
| **Generate Final Plan** | System compiles all inputs into regulatory-compliant PDF | Clicks "Generate HACCP Plan"; reviews 20-40 page document | Exports PDF formatted per FDA/GFSI requirements; stores version in system |

**User Interface:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AI HACCP Plan Builder - Step 1 of 9                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  What industry are you in?                                 â”‚
â”‚  â—‹ Food Manufacturing                                      â”‚
â”‚  â— Hospitality / Restaurant                                â”‚
â”‚  â—‹ Pharmaceuticals                                         â”‚
â”‚                                                             â”‚
â”‚  Great! What type of food service?                         â”‚
â”‚  [Dropdown: â–¼ Quick Service Restaurant (QSR)           ]   â”‚
â”‚                                                             â”‚
â”‚  What products do you serve?                               â”‚
â”‚  â˜‘ Fresh burgers (cooked to order)                        â”‚
â”‚  â˜‘ French fries                                            â”‚
â”‚  â˜‘ Salads (fresh vegetables)                               â”‚
â”‚  â˜ Ice cream / frozen desserts                             â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ AI SUGGESTION:                               â”‚          â”‚
â”‚  â”‚ Based on QSR burgers, I recommend:          â”‚          â”‚
â”‚  â”‚ â€¢ CCP 1: Cooking (pathogen kill step)       â”‚          â”‚
â”‚  â”‚ â€¢ CCP 2: Cold holding (prevent growth)      â”‚          â”‚
â”‚  â”‚ â€¢ CCP 3: Produce washing (contamination)    â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                             â”‚
â”‚  [â—€ Back]                        [Continue to Step 2 â–¶]    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AI HACCP Plan Builder - Step 4: Critical Control Points    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Your Process Flow:                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ Receive Frozen Patties â†’ Store in Freezer â”‚           â”‚
â”‚  â”‚         â†“                                  â”‚           â”‚
â”‚  â”‚ Cook on Grill â†’ [CCP 1: COOKING]          â”‚ â† CRITICALâ”‚
â”‚  â”‚         â†“                                  â”‚           â”‚
â”‚  â”‚ Assemble Burger â†’ Hold Hot                â”‚           â”‚
â”‚  â”‚         â†“                                  â”‚           â”‚
â”‚  â”‚ Serve to Customer                          â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                             â”‚
â”‚  ğŸ¤– AI Analysis:                                           â”‚
â”‚  CCP 1: COOKING is critical because:                      â”‚
â”‚  â€¢ Biological hazard: E. coli, Salmonella in raw beef     â”‚
â”‚  â€¢ Decision tree: Is control at this step necessary for   â”‚
â”‚    safety? YES                                             â”‚
â”‚  â€¢ Recommended critical limit: Internal temp â‰¥ 155Â°F      â”‚
â”‚    (FDA Food Code for ground beef)                         â”‚
â”‚                                                             â”‚
â”‚  âœï¸ Your Adjustments:                                      â”‚
â”‚  Critical Limit: [155Â°F internal temperature for 15 sec]  â”‚
â”‚  Monitoring: [Every burger, digital thermometer]          â”‚
â”‚  Frequency: [Continuous during service]                   â”‚
â”‚  Responsible: [Line Cook on duty]                         â”‚
â”‚                                                             â”‚
â”‚  âœ… CCP 1 looks good!                                      â”‚
â”‚                                                             â”‚
â”‚  [â—€ Back]  [Save & Continue to CCP 2 â–¶]  [Skip This CCP]  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Data Model:**

```json
{
  "haccp_plan": {
    "plan_id": "uuid",
    "account_id": "uuid",
    "facility_id": "uuid",
    "plan_name": "string",
    "industry": "enum[food_manufacturing, pharmaceuticals, hospitality]",
    "sub_industry": "string (e.g., 'QSR', 'Bakery', 'CMO')",
    "status": "enum[draft, active, archived]",
    "version": "semver (e.g., 1.0.0)",
    "created_by": "user_id",
    "created_at": "timestamp",
    "last_modified_at": "timestamp",
    "approved_by": "user_id",
    "approved_at": "timestamp",

    "product_description": {
      "product_name": "string",
      "product_type": "string",
      "ingredients": ["array of ingredients"],
      "allergens": ["array of allergen types"],
      "intended_use": "string",
      "intended_consumers": "string"
    },

    "process_flow": {
      "steps": [
        {
          "step_id": "uuid",
          "step_number": "integer",
          "step_name": "string",
          "step_description": "text",
          "equipment_used": ["array of equipment"],
          "duration_minutes": "integer (optional)",
          "temperature_range": "string (optional)",
          "is_ccp": "boolean"
        }
      ],
      "flow_diagram_url": "string (S3 URL to uploaded diagram)"
    },

    "hazard_analysis": [
      {
        "hazard_id": "uuid",
        "process_step_id": "uuid (FK to process_flow.steps)",
        "hazard_type": "enum[biological, chemical, physical]",
        "hazard_description": "text",
        "likelihood": "enum[high, medium, low]",
        "severity": "enum[high, medium, low]",
        "risk_level": "calculated (likelihood Ã— severity)",
        "preventive_measures": ["array of control measures"],
        "is_ccp": "boolean",
        "justification": "text (why CCP or not)"
      }
    ],

    "critical_control_points": [
      {
        "ccp_id": "uuid",
        "ccp_number": "integer (CCP 1, CCP 2, etc.)",
        "process_step_id": "uuid (FK)",
        "ccp_name": "string (e.g., 'Cooking')",
        "hazards_controlled": ["array of hazard_ids"],

        "critical_limits": [
          {
            "parameter": "string (e.g., 'Internal Temperature')",
            "limit_value": "string (e.g., 'â‰¥155Â°F')",
            "unit": "string (e.g., 'Â°F')",
            "tolerance": "string (e.g., '+/- 2Â°F')"
          }
        ],

        "monitoring": {
          "what": "string (what will be monitored)",
          "how": "string (method / equipment)",
          "frequency": "string (e.g., 'Every burger', 'Every 2 hours')",
          "who": "string (role / person)",
          "record_form": "string (reference to monitoring form template)"
        },

        "corrective_actions": [
          {
            "action_id": "uuid",
            "trigger": "string (when to take action)",
            "action_steps": ["array of steps"],
            "responsible_person": "string",
            "disposition_of_product": "string (discard, rework, etc.)"
          }
        ],

        "verification": {
          "methods": ["array of verification methods"],
          "frequency": "string (e.g., 'Weekly', 'Monthly')",
          "responsible_person": "string"
        }
      }
    ],

    "record_keeping": {
      "forms": [
        {
          "form_id": "uuid",
          "form_name": "string",
          "form_type": "enum[monitoring_log, corrective_action, verification]",
          "retention_period": "string (e.g., '2 years')",
          "storage_location": "string"
        }
      ]
    },

    "validation": {
      "validation_date": "date",
      "validation_method": "text",
      "validated_by": "user_id",
      "next_validation_date": "date"
    },

    "ai_metadata": {
      "template_used": "template_id",
      "ai_suggestions_accepted": "integer (count)",
      "ai_suggestions_rejected": "integer (count)",
      "time_to_complete_minutes": "integer"
    }
  }
}
```

---

#### Feature F1.2: Industry-Specific Templates Library

**Description:**
Pre-built, regulator-approved HACCP plan templates for 50+ common industry scenarios (bakery, dairy, meat processing, restaurant, pharma CMO, etc.). Users can select a template as a starting point, customize it to their specific needs, and have a compliant plan in minutes instead of hours.

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| **Browse Templates** | User explores available templates for their industry | Navigates to "HACCP Templates" library; filters by industry, product type | Displays grid of templates with preview thumbnails, popularity ratings |
| **Preview Template** | User reviews template contents before selecting | Clicks template card; views: Process flow, CCPs, critical limits, monitoring procedures | Shows read-only preview with "Use This Template" button |
| **Select & Customize** | User adopts template and personalizes for their facility | Clicks "Use This Template"; system copies template to user's account | Opens template in edit mode; AI highlights fields requiring customization |
| **Bulk Edit CCPs** | User adjusts critical limits across multiple CCPs at once | Selects multiple CCPs; edits critical limit values in bulk | Applies changes to all selected CCPs; logs changes in audit trail |
| **Save as Custom Template** | User creates reusable template for future products | Clicks "Save as Template"; names template (e.g., "Our Bakery Standard") | Saves to "My Templates" section; available for future HACCP plans |

**User Interface:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HACCP Templates Library                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Find a template for your industry:                        â”‚
â”‚  [ğŸ” Search templates...]                [Filter by: â–¼]    â”‚
â”‚                                                             â”‚
â”‚  ğŸ Food Manufacturing (23 templates)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ğŸ¥– Bakery â”‚  â”‚ğŸ¥› Dairy  â”‚  â”‚ğŸ– Meat   â”‚                â”‚
â”‚  â”‚Products  â”‚  â”‚Processingâ”‚  â”‚Processingâ”‚                â”‚
â”‚  â”‚â­â­â­â­â­   â”‚  â”‚â­â­â­â­    â”‚  â”‚â­â­â­â­â­   â”‚                â”‚
â”‚  â”‚15 plans  â”‚  â”‚8 plans   â”‚  â”‚12 plans  â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                             â”‚
â”‚  ğŸ” Hospitality / Restaurant (18 templates)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ğŸ” QSR    â”‚  â”‚ğŸ½ï¸ Full   â”‚  â”‚ğŸ¨ Hotel  â”‚                â”‚
â”‚  â”‚Burgers   â”‚  â”‚Service   â”‚  â”‚Catering  â”‚                â”‚
â”‚  â”‚â­â­â­â­â­   â”‚  â”‚â­â­â­â­    â”‚  â”‚â­â­â­     â”‚                â”‚
â”‚  â”‚20 plans  â”‚  â”‚10 plans  â”‚  â”‚5 plans   â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                             â”‚
â”‚  ğŸ’Š Pharmaceuticals (9 templates)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ğŸ’Š CMO    â”‚  â”‚ğŸŒ¿ Supple â”‚  â”‚âš—ï¸ Compnd â”‚                â”‚
â”‚  â”‚Tablets   â”‚  â”‚-ments    â”‚  â”‚Pharmacy  â”‚                â”‚
â”‚  â”‚â­â­â­â­    â”‚  â”‚â­â­â­â­â­   â”‚  â”‚â­â­â­     â”‚                â”‚
â”‚  â”‚6 plans   â”‚  â”‚8 plans   â”‚  â”‚3 plans   â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                             â”‚
â”‚  [Load More Templates...]                                  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Data Model:**

```json
{
  "haccp_template": {
    "template_id": "uuid",
    "template_name": "string",
    "industry": "enum",
    "sub_industry": "string",
    "product_category": "string",
    "description": "text",
    "thumbnail_url": "string (S3 URL)",
    "popularity_score": "integer (usage count)",
    "rating": "float (1.0 - 5.0)",
    "created_by": "enum[system, user]",
    "is_public": "boolean",
    "regulatory_standard": "string (e.g., 'FDA FSMA', 'GFSI', 'ISO 22000')",
    "last_updated": "timestamp",
    "usage_count": "integer",

    "template_content": {
      "process_flow": {...},
      "hazard_analysis": [...],
      "ccps": [...],
      "monitoring_procedures": [...]
    }
  }
}
```

---

#### Feature F1.3: Version Control & Change Management

**Description:**
Comprehensive versioning system that tracks all changes to HACCP plans over time, enabling users to compare versions, roll back changes, and maintain complete audit trail for regulatory compliance. Ensures that plan modifications (due to process changes, new regulations, or continuous improvement) are properly documented and approved.

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| **View Version History** | User reviews all past versions of a HACCP plan | Clicks "Version History" on plan page | Displays timeline of versions with dates, authors, change summaries |
| **Compare Versions** | User sees differences between two versions side-by-side | Selects two versions; clicks "Compare" | Highlights changes in diff view (additions in green, deletions in red) |
| **Request Plan Amendment** | User proposes change to active HACCP plan | Clicks "Request Change"; describes reason; submits for approval | Creates draft version; notifies QA manager for review |
| **Approve/Reject Change** | QA manager reviews proposed plan amendment | Reviews changes in approval workflow; adds comments; approves or rejects | If approved: Increments version (e.g., 1.0 â†’ 1.1); archives old version; If rejected: Notifies requestor with feedback |
| **Rollback to Previous Version** | User reverts to an earlier plan version | Selects archived version; clicks "Restore This Version" | Creates new version based on selected archived version; notifies stakeholders |
| **Schedule Plan Review** | System triggers periodic HACCP plan revalidation | System auto-creates review task based on schedule (e.g., annually) | Sends reminder to QA manager; opens plan for review/update |

**User Interface:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HACCP Plan: QSR Burger Operations - Version History        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Current Version: 2.1 (Active)                             â”‚
â”‚  Next Review Due: March 15, 2025                           â”‚
â”‚                                                             â”‚
â”‚  Version Timeline:                                         â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚  â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—              â”‚
â”‚  v1.0           v1.1      v2.0             v2.1            â”‚
â”‚  Jan 2024      Mar 2024  Jun 2024        Dec 2024          â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ v2.1 (Active) - Dec 10, 2024                â”‚         â”‚
â”‚  â”‚ Modified by: Sarah Chen (QA Manager)        â”‚         â”‚
â”‚  â”‚ Change Summary: Updated cooking temp from   â”‚         â”‚
â”‚  â”‚ 155Â°F to 160Â°F per new FDA guidance        â”‚         â”‚
â”‚  â”‚ Status: âœ… Approved                         â”‚         â”‚
â”‚  â”‚ [View Details] [Compare with v2.0]         â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ v2.0 - Jun 5, 2024                          â”‚         â”‚
â”‚  â”‚ Modified by: Tom Martinez (Owner)           â”‚         â”‚
â”‚  â”‚ Change Summary: Added new CCP for produce   â”‚         â”‚
â”‚  â”‚ washing (E. coli outbreak prompted change)  â”‚         â”‚
â”‚  â”‚ Status: âœ… Approved                         â”‚         â”‚
â”‚  â”‚ [View Details] [Restore This Version]      â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                             â”‚
â”‚  [Request Change to Current Plan]  [Schedule Review]       â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Data Model:**

```json
{
  "plan_version": {
    "version_id": "uuid",
    "plan_id": "uuid (FK to haccp_plan)",
    "version_number": "semver (e.g., 2.1.0)",
    "status": "enum[draft, pending_approval, approved, rejected, archived]",
    "created_by": "user_id",
    "created_at": "timestamp",
    "approved_by": "user_id (nullable)",
    "approved_at": "timestamp (nullable)",
    "change_summary": "text",
    "change_reason": "text",
    "change_type": "enum[minor_edit, major_revision, regulatory_update]",

    "change_log": [
      {
        "field_changed": "string (e.g., 'CCP 1 critical limit')",
        "old_value": "string",
        "new_value": "string",
        "changed_by": "user_id",
        "changed_at": "timestamp"
      }
    ],

    "plan_snapshot": {
      /* Full HACCP plan object at this version */
    },

    "approval_workflow": {
      "requested_by": "user_id",
      "requested_at": "timestamp",
      "approvers_required": ["array of user_ids"],
      "approvals": [
        {
          "approver_id": "user_id",
          "approved_at": "timestamp",
          "decision": "enum[approved, rejected, requested_changes]",
          "comments": "text"
        }
      ]
    },

    "review_schedule": {
      "review_frequency": "enum[quarterly, semi_annually, annually]",
      "last_review_date": "date",
      "next_review_date": "date",
      "reviewer_assigned": "user_id"
    }
  }
}
```

---

#### Feature F1.4: Multi-Language Support

**Description:**
HACCP plans and monitoring interfaces available in multiple languages to support diverse workforces. Particularly critical for food manufacturing where floor staff often speak Spanish, Mandarin, Vietnamese, or other languages as their primary language. System stores HACCP plan content in multiple languages while maintaining single source of truth for regulatory compliance.

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| **Select Plan Language** | User chooses language for HACCP plan display | Opens plan; clicks language selector; chooses from available languages | Renders plan content in selected language; CCPs, critical limits, procedures translated |
| **Translate Plan Content** | System provides AI-powered translation of custom plan text | Clicks "Translate Plan"; selects target languages (Spanish, Mandarin, etc.) | AI translates custom text fields; flags technical terms for manual review |
| **Review & Validate Translation** | QA manager reviews auto-translated content for accuracy | Opens translation review interface; edits machine-translated text | Saves validated translation; marks as "approved" for use by floor staff |
| **Switch Language in Mobile App** | Floor staff uses app in their preferred language | Opens mobile app settings; selects language | Entire app UI switches to selected language; monitoring tasks, prompts translated |
| **Print Multi-Language Forms** | User generates monitoring forms in multiple languages | Selects "Print Forms"; checks languages to include (English + Spanish) | Generates bilingual PDF with side-by-side English/Spanish columns |

**User Interface:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HACCP Plan: PanaderÃ­a (Bakery) Operations                  â”‚
â”‚ Language: EspaÃ±ol (Spanish) â–¼                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  CCP 1: HORNEADO (CocciÃ³n)                                â”‚
â”‚  Peligro Controlado: PatÃ³genos (E. coli, Salmonella)      â”‚
â”‚                                                             â”‚
â”‚  LÃ­mite CrÃ­tico:                                           â”‚
â”‚  Temperatura interna â‰¥ 75Â°C (165Â°F) por 15 segundos       â”‚
â”‚                                                             â”‚
â”‚  Monitoreo:                                                â”‚
â”‚  Â¿QuÃ©?: Temperatura interna del pan                       â”‚
â”‚  Â¿CÃ³mo?: TermÃ³metro digital de sonda                      â”‚
â”‚  Â¿CuÃ¡ndo?: Cada hornada                                   â”‚
â”‚  Â¿QuiÃ©n?: Panadero de turno                               â”‚
â”‚                                                             â”‚
â”‚  AcciÃ³n Correctiva:                                        â”‚
â”‚  Si la temperatura es < 75Â°C:                              â”‚
â”‚  1. Continuar horneando hasta alcanzar 75Â°C               â”‚
â”‚  2. Verificar calibraciÃ³n del termÃ³metro                   â”‚
â”‚  3. Registrar la acciÃ³n tomada                             â”‚
â”‚  4. Notificar al supervisor                                â”‚
â”‚                                                             â”‚
â”‚  [â¬…ï¸ Anterior] [English | EspaÃ±ol | ä¸­æ–‡ | Tiáº¿ng Viá»‡t] [Siguiente â¡ï¸] â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Data Model:**

```json
{
  "plan_translation": {
    "translation_id": "uuid",
    "plan_id": "uuid (FK)",
    "language_code": "string (ISO 639-1, e.g., 'es', 'zh', 'vi')",
    "translated_by": "enum[ai, human, hybrid]",
    "translation_status": "enum[draft, review_needed, approved]",
    "reviewed_by": "user_id (if human-reviewed)",
    "reviewed_at": "timestamp",

    "translated_content": {
      "plan_name": "string",
      "product_description": "string",
      "process_steps": [
        {
          "step_id": "uuid (FK)",
          "step_name": "string (translated)",
          "step_description": "text (translated)"
        }
      ],
      "ccps": [
        {
          "ccp_id": "uuid (FK)",
          "ccp_name": "string (translated)",
          "critical_limits": "string (translated)",
          "monitoring_procedures": "text (translated)",
          "corrective_actions": "text (translated)"
        }
      ]
    },

    "terminology_glossary": [
      {
        "term_english": "string (e.g., 'Critical Control Point')",
        "term_translated": "string (e.g., 'Punto CrÃ­tico de Control')",
        "definition": "text"
      }
    ]
  }
}
```

---

### 1.3 Module 1 Data Models Summary

**Core Entities:**
1. `haccp_plan` - Master HACCP plan record
2. `plan_version` - Version control and change history
3. `haccp_template` - Pre-built industry templates
4. `plan_translation` - Multi-language support

**Entity Relationships:**
```
haccp_plan (1) â”€â”€< (M) plan_version
haccp_plan (1) â”€â”€< (M) plan_translation
haccp_template (1) â”€â”€< (M) haccp_plan (via template_id)
account (1) â”€â”€< (M) haccp_plan
facility (1) â”€â”€< (M) haccp_plan
user (1) â”€â”€< (M) haccp_plan (created_by, approved_by)
```

---

## Module 2: Daily Monitoring & Data Capture

### 2.1 Module Overview

**Purpose:** Enable floor staff to quickly and easily capture HACCP monitoring data through mobile devices, with offline capability, QR code scanning, photo evidence, and automatic validation against critical limits.

**Target Users:**
- Floor Staff / Operators (primary data entry)
- Shift Supervisors (verify data, approve exceptions)
- QA Managers (review aggregated monitoring data)

**Key Outcomes:**
- Sub-30-second task completion time (vs. 3-5 minutes with paper)
- 100% data capture compliance (no missed checks)
- Real-time critical limit validation and alerting
- Offline-capable (works without WiFi on production floor)
- Photo/video evidence attached to every check

---

### 2.2 Features & Operations

#### Feature F2.1: Mobile Monitoring App (iOS/Android)

**Description:**
Native mobile applications (iOS and Android) that guide floor staff through daily HACCP monitoring tasks with consumer-app-grade simplicity. App works offline-first, stores data locally, and syncs to cloud when connectivity is available. Designed for gloved hands, noisy environments, and users with basic tech literacy.

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| **Receive Task Notification** | App alerts user when monitoring task is due | Push notification appears: "Time to check Freezer #3 temp" | User taps notification; app opens directly to task |
| **Scan QR Code** | User identifies monitoring location/equipment | Opens app; taps camera icon; scans QR code on equipment | App auto-fills: Location, Equipment ID, CCP reference; loads critical limits |
| **Enter Measurement** | User manually enters monitored value | Types temperature (e.g., "38Â°F") into number field | App validates in real-time; shows green (OK) or red (violation) indicator |
| **Capture Photo Evidence** | User takes photo of thermometer, product, or situation | Taps camera icon; takes photo; photo auto-attaches to record | Photo stamped with: timestamp, GPS coordinates (if enabled), user ID |
| **Voice-to-Text Entry** | User speaks measurement instead of typing | Taps microphone icon; says "Temperature is thirty-eight degrees" | AI converts speech to text; enters "38" in temperature field |
| **Submit Offline** | User submits record without internet connection | Taps "Submit"; sees "Saved locally, will sync when online" | Record stored in local SQLite database; queued for sync |
| **Background Sync** | App automatically uploads data when connectivity restored | (Automatic, no user action) WiFi/cellular detected | App syncs queued records to server; shows sync progress notification |

**User Interface:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”” [9:00 AM] Time to check Freezer #3 Temperature         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â‰¡ HACCP Monitor                            ğŸ”” ğŸ‘¤ John â–¼    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  CCP 2: Cold Holding - Freezer #3                         â”‚
â”‚  Critical Limit: â‰¤ 0Â°F (-18Â°C)                             â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ ğŸ“· Scan QR code on freezer door        â”‚              â”‚
â”‚  â”‚                                         â”‚              â”‚
â”‚  â”‚     â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“                   â”‚              â”‚
â”‚  â”‚     â–“â–“ QR CODE â–“â–“                       â”‚              â”‚
â”‚  â”‚     â–“â–“  SCAN   â–“â–“                       â”‚              â”‚
â”‚  â”‚     â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“                   â”‚              â”‚
â”‚  â”‚                                         â”‚              â”‚
â”‚  â”‚  Or enter equipment ID manually:       â”‚              â”‚
â”‚  â”‚  [FREEZER-003                        ] â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                â”‚
â”‚                                                             â”‚
â”‚  ğŸŒ¡ï¸ Temperature Reading:                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  -5  Â°F                     ğŸ¤            â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                     â¬†ï¸ Tap mic for voice entry             â”‚
â”‚                                                             â”‚
â”‚  âœ… Within Limit (â‰¤ 0Â°F)                                  â”‚
â”‚                                                             â”‚
â”‚  ğŸ“¸ Photo Evidence:                                        â”‚
â”‚  [ğŸ“· Take Photo of Thermometer Display]                   â”‚
â”‚                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                â”‚
â”‚                                                             â”‚
â”‚  Notes (optional):                                         â”‚
â”‚  [                                        ]                â”‚
â”‚                                                             â”‚
â”‚  [âŒ Cancel]                    [âœ… Submit Check]          â”‚
â”‚                                                             â”‚
â”‚  âš ï¸ Offline Mode - Will sync when online                  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â‰¡ HACCP Monitor                            ğŸ”” ğŸ‘¤ Maria â–¼   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ğŸš¨ CRITICAL LIMIT VIOLATION                               â”‚
â”‚                                                             â”‚
â”‚  CCP 2: Cold Holding - Freezer #3                         â”‚
â”‚  Critical Limit: â‰¤ 0Â°F (-18Â°C)                             â”‚
â”‚  Your Reading: 15Â°F                                        â”‚
â”‚                                                             â”‚
â”‚  âš ï¸ Temperature is ABOVE safe limit!                       â”‚
â”‚                                                             â”‚
â”‚  ğŸ“ Corrective Action Required:                            â”‚
â”‚                                                             â”‚
â”‚  What happened?                                            â”‚
â”‚  â—‹ Equipment malfunction                                   â”‚
â”‚  â— Door left open                                          â”‚
â”‚  â—‹ Power outage                                            â”‚
â”‚  â—‹ Other: _________________                                â”‚
â”‚                                                             â”‚
â”‚  What did you do?                                          â”‚
â”‚  â˜‘ Closed freezer door immediately                        â”‚
â”‚  â˜‘ Checked product temp (still safe at 10Â°F)              â”‚
â”‚  â˜ Moved product to backup freezer                        â”‚
â”‚  â˜ Discarded affected product                             â”‚
â”‚                                                             â”‚
â”‚  ğŸ“¸ Take photo of thermometer:                             â”‚
â”‚  [Photo: thermometer_15F_1208_0902.jpg]                   â”‚
â”‚                                                             â”‚
â”‚  ğŸ“¸ Take photo of product (if affected):                   â”‚
â”‚  [ğŸ“· Take Photo]                                           â”‚
â”‚                                                             â”‚
â”‚  âœï¸ Additional notes:                                      â”‚
â”‚  [Door was accidentally left open during stocking.         â”‚
â”‚   Closed immediately, will retrain staff.]                 â”‚
â”‚                                                             â”‚
â”‚  [âŒ Cancel]                    [âœ… Submit & Notify Manager]â”‚
â”‚                                                             â”‚
â”‚  âš ï¸ Manager will be notified for review                   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Data Model:**

```json
{
  "monitoring_record": {
    "record_id": "uuid",
    "plan_id": "uuid (FK to haccp_plan)",
    "ccp_id": "uuid (FK to critical_control_point)",
    "facility_id": "uuid",
    "equipment_id": "string (e.g., 'FREEZER-003')",
    "location": "string (e.g., 'Production Floor, Station 5')",

    "monitored_by": "user_id",
    "monitored_at": "timestamp (when check performed)",
    "submitted_at": "timestamp (when submitted to server)",
    "sync_status": "enum[pending_sync, synced, sync_failed]",

    "measurement": {
      "parameter": "string (e.g., 'Temperature')",
      "value": "float (e.g., -5.0)",
      "unit": "string (e.g., 'Â°F')",
      "method": "enum[manual_entry, voice_to_text, iot_sensor]",
      "equipment_used": "string (e.g., 'Digital thermometer DT-301')"
    },

    "critical_limit": {
      "limit_value": "string (e.g., 'â‰¤ 0Â°F')",
      "is_within_limit": "boolean",
      "deviation_amount": "float (nullable, if violated)"
    },

    "evidence": {
      "photos": [
        {
          "photo_id": "uuid",
          "photo_url": "string (S3 URL)",
          "taken_at": "timestamp",
          "gps_coordinates": "object (lat, long, nullable)",
          "caption": "string (optional)"
        }
      ],
      "videos": [
        {
          "video_id": "uuid",
          "video_url": "string (S3 URL)",
          "duration_seconds": "integer",
          "taken_at": "timestamp"
        }
      ]
    },

    "qr_code_scan": {
      "qr_code_id": "string (decoded from QR)",
      "scanned_at": "timestamp",
      "scan_location_gps": "object (lat, long, nullable)"
    },

    "notes": "text (optional user comments)",

    "corrective_action_triggered": "boolean",
    "corrective_action_id": "uuid (nullable, FK if violation occurred)",

    "verified_by": "user_id (nullable, if supervisor review required)",
    "verified_at": "timestamp (nullable)",

    "mobile_app_metadata": {
      "app_version": "string",
      "device_type": "enum[ios, android]",
      "device_model": "string",
      "offline_mode": "boolean (was record captured offline?)",
      "sync_attempts": "integer",
      "geolocation_enabled": "boolean"
    }
  }
}
```

---

#### Feature F2.2: QR Code Scanning & Equipment Identification

**Description:**
Rapid equipment and location identification through QR code scanning, eliminating manual data entry and reducing task completion time. System generates printable QR codes for all monitoring locations and equipment, which encode: equipment ID, location, CCP reference, and critical limits. Floor staff simply scans the QR code to auto-populate monitoring forms.

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| **Generate QR Codes** | Admin creates QR codes for all equipment/locations | Navigates to "Equipment Setup"; clicks "Generate QR Codes" for each equipment | System generates unique QR code encoding: Equipment ID, CCP, Location; displays printable label sheet |
| **Print QR Labels** | User prints QR code labels to affix to equipment | Clicks "Print Labels"; selects label sheet size (Avery 5160, etc.) | Generates print-ready PDF with QR codes formatted for label sheets |
| **Scan QR Code (Mobile)** | Floor staff scans QR code to start monitoring task | Opens mobile app; taps camera; points at QR code on equipment | App decodes QR; auto-fills: Equipment ID, Location, CCP, Critical Limits; opens data entry form |
| **Manual Entry Fallback** | User enters equipment ID manually if QR damaged/missing | Types equipment ID into search field | App looks up equipment; loads same data as QR scan would provide |
| **Verify Equipment Calibration** | QR code links to equipment calibration status | After scanning QR, app shows "Last calibrated: 12/01/2024" | User confirms equipment is within calibration date; proceeds with monitoring |

**User Interface:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Equipment Setup - Generate QR Codes                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Equipment List:                                           â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ FREEZER-003 (Walk-in Freezer #3)            â”‚         â”‚
â”‚  â”‚ Location: Production Floor, North Wall      â”‚         â”‚
â”‚  â”‚ CCP: CCP 2 - Cold Holding                   â”‚         â”‚
â”‚  â”‚ Critical Limit: â‰¤ 0Â°F                       â”‚         â”‚
â”‚  â”‚                                              â”‚         â”‚
â”‚  â”‚  â–“â–“â–“â–“â–“â–“â–“â–“                                   â”‚         â”‚
â”‚  â”‚  â–“â–“ QR  â–“â–“  â† FREEZER-003                   â”‚         â”‚
â”‚  â”‚  â–“â–“CODE â–“â–“     Scan to Monitor               â”‚         â”‚
â”‚  â”‚  â–“â–“â–“â–“â–“â–“â–“â–“                                   â”‚         â”‚
â”‚  â”‚                                              â”‚         â”‚
â”‚  â”‚  [ğŸ“„ Print Label]  [ğŸ“‹ Copy QR Data]        â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ OVEN-001 (Commercial Oven #1)               â”‚         â”‚
â”‚  â”‚ Location: Kitchen, Station 2                â”‚         â”‚
â”‚  â”‚ CCP: CCP 1 - Cooking (Kill Step)            â”‚         â”‚
â”‚  â”‚ Critical Limit: â‰¥ 155Â°F internal             â”‚         â”‚
â”‚  â”‚                                              â”‚         â”‚
â”‚  â”‚  â–“â–“â–“â–“â–“â–“â–“â–“                                   â”‚         â”‚
â”‚  â”‚  â–“â–“ QR  â–“â–“  â† OVEN-001                      â”‚         â”‚
â”‚  â”‚  â–“â–“CODE â–“â–“     Scan to Monitor               â”‚         â”‚
â”‚  â”‚  â–“â–“â–“â–“â–“â–“â–“â–“                                   â”‚         â”‚
â”‚  â”‚                                              â”‚         â”‚
â”‚  â”‚  [ğŸ“„ Print Label]  [ğŸ“‹ Copy QR Data]        â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                             â”‚
â”‚  [ğŸ–¨ï¸ Print All QR Codes (Label Sheet)]                    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Data Model:**

```json
{
  "equipment": {
    "equipment_id": "string (primary key, e.g., 'FREEZER-003')",
    "equipment_name": "string",
    "equipment_type": "enum[freezer, refrigerator, oven, cooler, etc.]",
    "facility_id": "uuid (FK)",
    "location": "string",
    "manufacturer": "string",
    "model": "string",
    "serial_number": "string",

    "ccp_assignments": [
      {
        "ccp_id": "uuid (FK to critical_control_point)",
        "is_primary_equipment": "boolean"
      }
    ],

    "calibration": {
      "last_calibrated_date": "date",
      "calibration_due_date": "date",
      "calibration_frequency_days": "integer",
      "calibrated_by": "string",
      "calibration_certificate_url": "string (S3 URL)"
    },

    "qr_code": {
      "qr_code_data": "string (encoded JSON with equipment details)",
      "qr_code_image_url": "string (S3 URL to QR image)",
      "generated_at": "timestamp",
      "print_count": "integer"
    },

    "maintenance": {
      "last_service_date": "date",
      "next_service_due": "date",
      "maintenance_notes": "text"
    },

    "status": "enum[active, out_of_service, decommissioned]",
    "created_at": "timestamp",
    "updated_at": "timestamp"
  }
}
```

---

#### Feature F2.3: Offline-First Architecture & Background Sync

**Description:**
Mobile app operates fully offline, storing all data locally in device SQLite database, enabling floor staff to continue monitoring even in areas with no WiFi/cellular connectivity. When connectivity is restored, app automatically syncs data to cloud in the background. Ensures 100% data capture even in environments with unreliable internet.

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| **Offline Data Capture** | User records monitoring data without internet | Opens app (offline); scans QR; enters data; takes photo; submits | App saves record to local SQLite; adds to sync queue; shows "Saved offline" confirmation |
| **Detect Connectivity** | App continuously monitors network status | (Automatic background process) | App detects WiFi/cellular connection; triggers sync process |
| **Background Sync** | App uploads queued records to server | (Automatic when online) | App sends POST requests for each queued record; server responds with sync confirmation |
| **Conflict Resolution** | Handle case where same record edited offline and online | User submits offline record; server detects newer version exists | App shows conflict notification; user chooses: "Keep Server Version" or "Keep My Version" |
| **View Sync Status** | User checks which records are pending sync | Opens "Sync Status" screen in app settings | Shows: 5 records pending sync; last sync: 10 minutes ago; tap to force sync now |
| **Force Manual Sync** | User triggers immediate sync (e.g., before leaving site) | Taps "Sync Now" button | App immediately attempts to sync all pending records; shows progress bar |

**User Interface:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â‰¡ HACCP Monitor                Settings â†’ Sync Status     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ğŸ“¡ Connection Status: âš ï¸ Offline (No WiFi)                â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ Pending Sync: 5 records                    â”‚          â”‚
â”‚  â”‚                                             â”‚          â”‚
â”‚  â”‚ â€¢ Freezer temp check (9:00 AM)             â”‚          â”‚
â”‚  â”‚ â€¢ Oven temp check (9:15 AM)                â”‚          â”‚
â”‚  â”‚ â€¢ Cooler temp check (9:30 AM)              â”‚          â”‚
â”‚  â”‚ â€¢ Freezer temp check (10:00 AM)            â”‚          â”‚
â”‚  â”‚ â€¢ Corrective action (10:15 AM)             â”‚          â”‚
â”‚  â”‚                                             â”‚          â”‚
â”‚  â”‚ Last successful sync: 8:45 AM               â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                             â”‚
â”‚  â„¹ï¸ Your data is saved locally. It will automatically      â”‚
â”‚     sync when you have internet connection.                â”‚
â”‚                                                             â”‚
â”‚  [ğŸ”„ Retry Sync Now] (grayed out - offline)               â”‚
â”‚                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                â”‚
â”‚                                                             â”‚
â”‚  Local Storage:                                            â”‚
â”‚  Used: 45 MB of 500 MB                                     â”‚
â”‚  Records stored: 342                                       â”‚
â”‚  Photos stored: 89                                         â”‚
â”‚                                                             â”‚
â”‚  [ğŸ—‘ï¸ Clear Synced Data (Free Up Space)]                   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“¡ WiFi Connected - Syncing...                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Uploading 5 records to server                             â”‚
â”‚                                                             â”‚
â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  60% (3 of 5)                    â”‚
â”‚                                                             â”‚
â”‚  âœ… Freezer temp check (9:00 AM) - Synced                  â”‚
â”‚  âœ… Oven temp check (9:15 AM) - Synced                     â”‚
â”‚  âœ… Cooler temp check (9:30 AM) - Synced                   â”‚
â”‚  â³ Freezer temp check (10:00 AM) - Uploading...           â”‚
â”‚  â¹ï¸ Corrective action (10:15 AM) - Waiting...              â”‚
â”‚                                                             â”‚
â”‚  Uploading photos: 2 of 3 complete                         â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Data Model:**

```json
{
  "sync_queue": {
    "queue_id": "uuid",
    "record_id": "uuid (FK to monitoring_record or corrective_action)",
    "record_type": "enum[monitoring_record, corrective_action, photo, video]",
    "user_id": "uuid",
    "device_id": "string (unique device identifier)",

    "sync_status": "enum[pending, in_progress, completed, failed]",
    "created_at": "timestamp (when queued locally)",
    "sync_attempts": "integer",
    "last_sync_attempt": "timestamp (nullable)",
    "synced_at": "timestamp (nullable)",

    "payload": "json (full record data to sync)",

    "error_info": {
      "error_code": "string (nullable)",
      "error_message": "text (nullable)",
      "retry_after": "timestamp (nullable, exponential backoff)"
    },

    "conflict_resolution": {
      "has_conflict": "boolean",
      "server_version": "json (nullable, if conflict detected)",
      "resolution": "enum[keep_local, keep_server, merged] (nullable)"
    }
  },

  "device_sync_status": {
    "device_id": "string (primary key)",
    "user_id": "uuid",
    "device_name": "string",
    "last_online_at": "timestamp",
    "last_sync_at": "timestamp",
    "pending_records_count": "integer",
    "total_synced_records": "integer",
    "local_storage_used_mb": "integer",
    "app_version": "string",
    "os_version": "string"
  }
}
```

---

#### Feature F2.4: Photo & Video Evidence Capture

**Description:**
Integrated camera functionality for capturing visual evidence of monitoring activities, critical limit violations, product conditions, and corrective actions. Photos and videos are automatically timestamped, geotagged (if enabled), and linked to monitoring records. Supports both real-time capture and attachment of existing photos from device gallery.

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| **Capture Photo** | User takes photo with device camera | Taps camera icon in monitoring form; aligns shot; taps shutter | App captures photo; stamps with: timestamp, user ID, GPS coords; displays thumbnail preview |
| **Capture Video** | User records short video (e.g., showing process flow) | Taps video icon; starts recording; stops after 5-30 seconds | App saves video; limits duration to 30 sec; compresses for upload; shows preview |
| **Attach Multiple Photos** | User takes multiple photos for single monitoring event | Taps "Add Another Photo"; repeats capture; max 5 photos per record | Each photo added to evidence array; shows gallery of thumbnails |
| **Annotate Photo** | User adds text overlay or drawing to photo | After capturing photo, taps "Annotate"; adds arrow, circle, text label | Photo editor opens; user marks specific areas (e.g., circling thermometer reading) |
| **Photo from Gallery** | User attaches existing photo from device | Taps "Choose from Gallery"; selects photo from device | App imports photo; asks user to confirm it's related to current task |
| **Compress & Upload** | System optimizes photos for upload to save bandwidth | (Automatic on submit) | App compresses photos to max 1MB each; uploads to S3; saves URL in record |
| **View Photo History** | User reviews all photos for a specific equipment/CCP | Opens CCP detail page; taps "Photo History" | Displays chronological gallery of all photos for that CCP |

**User Interface:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Photo Evidence Capture                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  CCP 2: Cold Holding - Freezer #3                         â”‚
â”‚  Temperature: 15Â°F (VIOLATION)                             â”‚
â”‚                                                             â”‚
â”‚  ğŸ“¸ Photo Evidence (Required for violations):              â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚          â”‚  â”‚          â”‚  â”‚   â•     â”‚                â”‚
â”‚  â”‚  Photo 1 â”‚  â”‚  Photo 2 â”‚  â”‚   Add    â”‚                â”‚
â”‚  â”‚ Thermo-  â”‚  â”‚ Product  â”‚  â”‚  Photo   â”‚                â”‚
â”‚  â”‚  meter   â”‚  â”‚  In      â”‚  â”‚          â”‚                â”‚
â”‚  â”‚ Reading  â”‚  â”‚ Freezer  â”‚  â”‚          â”‚                â”‚
â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚                â”‚
â”‚  â”‚ [âœï¸ Edit] â”‚  â”‚ [âœï¸ Edit] â”‚  â”‚          â”‚                â”‚
â”‚  â”‚ [ğŸ—‘ï¸ Del]  â”‚  â”‚ [ğŸ—‘ï¸ Del]  â”‚  â”‚          â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                             â”‚
â”‚  Photo 1: thermometer_15F_120824.jpg                       â”‚
â”‚  Taken: Dec 8, 2024 10:15 AM                               â”‚
â”‚  By: Maria Rodriguez                                       â”‚
â”‚  Size: 0.8 MB                                              â”‚
â”‚                                                             â”‚
â”‚  [ğŸ“· Take Photo]  [ğŸ–¼ï¸ Choose from Gallery]  [ğŸ¥ Record Video] â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Data Model:**

```json
{
  "media_evidence": {
    "media_id": "uuid",
    "record_id": "uuid (FK to monitoring_record or corrective_action)",
    "media_type": "enum[photo, video]",
    "file_name": "string",
    "file_size_bytes": "integer",
    "file_url": "string (S3 URL)",
    "thumbnail_url": "string (S3 URL for video thumbnail)",

    "captured_by": "user_id",
    "captured_at": "timestamp",
    "uploaded_at": "timestamp",

    "camera_metadata": {
      "device_camera": "string (front, rear)",
      "resolution": "string (e.g., '1920x1080')",
      "file_format": "string (e.g., 'JPEG', 'MP4')",
      "original_size_bytes": "integer",
      "compression_ratio": "float"
    },

    "gps_metadata": {
      "latitude": "float (nullable)",
      "longitude": "float (nullable)",
      "accuracy_meters": "float (nullable)",
      "altitude_meters": "float (nullable)"
    },

    "annotations": [
      {
        "annotation_type": "enum[text, arrow, circle, freehand]",
        "coordinates": "object (x, y positions)",
        "text_content": "string (nullable, if text annotation)",
        "color": "string (hex color code)",
        "timestamp": "timestamp (when annotation added)"
      }
    ],

    "sync_status": "enum[local_only, uploading, uploaded]",
    "upload_attempts": "integer",
    "upload_error": "text (nullable)"
  }
}
```

---

### 2.3 Module 2 Data Models Summary

**Core Entities:**
1. `monitoring_record` - Daily monitoring data captures
2. `equipment` - Equipment registry with QR codes
3. `sync_queue` - Offline sync management
4. `media_evidence` - Photo/video evidence
5. `device_sync_status` - Device synchronization tracking

**Entity Relationships:**
```
haccp_plan (1) â”€â”€< (M) monitoring_record
critical_control_point (1) â”€â”€< (M) monitoring_record
equipment (1) â”€â”€< (M) monitoring_record
user (1) â”€â”€< (M) monitoring_record
monitoring_record (1) â”€â”€< (M) media_evidence
monitoring_record (1) â”€â”€> (1) corrective_action (if violation)
```

---

## Module 3: Corrective Action Management

### 3.1 Module Overview

**Purpose:** Guide users through structured corrective action workflows when critical limits are violated, ensuring proper documentation, manager approval, and regulatory compliance.

**Target Users:**
- Floor Staff (initiate corrective actions)
- Shift Supervisors (review and approve actions)
- QA Managers (verify effectiveness, analyze trends)

**Key Outcomes:**
- 100% of violations have documented corrective actions
- Average corrective action completion time <30 minutes
- Manager approval workflow ensures oversight
- Root cause analysis prevents recurrence
- Full audit trail for regulatory inspection

---

### 3.2 Features & Operations

#### Feature F3.1: Guided Corrective Action Workflow

**Description:**
Step-by-step wizard that walks floor staff through corrective action procedures when a critical limit is violated. System provides pre-written corrective action steps from HACCP plan, prompts user to select actions taken, requires photo evidence, and automatically notifies managers for verification.

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| **Trigger Corrective Action** | Violation detected during monitoring | User submits monitoring record with out-of-limit reading | System auto-creates corrective action draft; displays wizard overlay; blocks user from continuing until addressed |
| **Identify Root Cause** | User selects reason for violation | Chooses from predefined options (equipment failure, human error, etc.) or enters custom reason | System records root cause; suggests relevant corrective action steps based on selection |
| **Select Actions Taken** | User checks off corrective steps performed | Reviews pre-written action steps from HACCP plan; checks boxes for actions taken | System validates all required steps completed; prompts for additional info if needed |
| **Disposition Product** | User documents what happened to affected product | Selects: Discarded, Reworked, Released (if safe), On Hold | If "Discarded": Prompts for quantity/batch number; if "Released": Requires manager approval |
| **Capture Evidence** | User photographs corrective action results | Takes photo of: discarded product, repaired equipment, or corrected process | Photo auto-attached to corrective action record |
| **Submit for Manager Review** | User completes corrective action and submits | Taps "Submit for Review"; adds optional notes | System sends push notification to shift supervisor; marks CA as "Pending Approval" |

**User Interface:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸš¨ Corrective Action Wizard - Step 1 of 5                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Critical Limit Violation Detected                         â”‚
â”‚                                                             â”‚
â”‚  CCP 2: Cold Holding - Freezer #3                         â”‚
â”‚  Critical Limit: â‰¤ 0Â°F                                     â”‚
â”‚  Your Reading: 15Â°F (OVER by 15Â°F)                        â”‚
â”‚  Time: Dec 8, 2024 10:15 AM                                â”‚
â”‚                                                             â”‚
â”‚  â“ What caused this violation?                            â”‚
â”‚  (Select the most likely reason)                           â”‚
â”‚                                                             â”‚
â”‚  â—‹ Equipment malfunction (compressor, thermostat)          â”‚
â”‚  â— Door left open/not sealed properly                      â”‚
â”‚  â—‹ Power outage or electrical issue                        â”‚
â”‚  â—‹ Overloading (too much warm product added)               â”‚
â”‚  â—‹ Unknown - needs investigation                           â”‚
â”‚  â—‹ Other: [___________________________]                    â”‚
â”‚                                                             â”‚
â”‚  [Cancel]                          [Next: Actions Taken â–¶] â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸš¨ Corrective Action Wizard - Step 2 of 5                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Root Cause: Door left open                                â”‚
â”‚                                                             â”‚
â”‚  âœ… What actions did you take?                             â”‚
â”‚  (Check all that apply)                                    â”‚
â”‚                                                             â”‚
â”‚  â˜‘ Closed freezer door immediately                        â”‚
â”‚  â˜‘ Checked product temperature (safe if â‰¤ 41Â°F)           â”‚
â”‚  â˜‘ Verified door seal is intact                           â”‚
â”‚  â˜ Moved product to backup freezer                        â”‚
â”‚  â˜ Called maintenance to repair                           â”‚
â”‚  â˜ Discarded affected product                             â”‚
â”‚                                                             â”‚
â”‚  â• Add custom action: [_______________________]           â”‚
â”‚                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                â”‚
â”‚                                                             â”‚
â”‚  ğŸ“ Additional details (optional):                         â”‚
â”‚  [Door was left open during stocking. Closed              â”‚
â”‚   immediately. Product temp still at 10Â°F (safe).]        â”‚
â”‚                                                             â”‚
â”‚  [â—€ Back]                      [Next: Product Disposition â–¶] â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸš¨ Corrective Action Wizard - Step 3 of 5                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ğŸ– What happened to the product?                          â”‚
â”‚                                                             â”‚
â”‚  â—‹ Discarded (thrown away)                                 â”‚
â”‚  â—‹ Reworked (re-cooled, reprocessed)                      â”‚
â”‚  â— Released (product is safe)                              â”‚
â”‚  â—‹ On Hold (awaiting QA decision)                         â”‚
â”‚                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                â”‚
â”‚                                                             â”‚
â”‚  âœ… Released - Product is Safe                             â”‚
â”‚                                                             â”‚
â”‚  Why is the product safe despite the violation?           â”‚
â”‚  [Product temp was only 10Â°F (well below 41Â°F danger      â”‚
â”‚   zone). Door was open <5 minutes. No safety risk.]       â”‚
â”‚                                                             â”‚
â”‚  Batch/Lot Numbers Affected:                               â”‚
â”‚  [LOT-2024-1208-A]                                         â”‚
â”‚                                                             â”‚
â”‚  Quantity Affected:                                        â”‚
â”‚  [50 lbs]                                                  â”‚
â”‚                                                             â”‚
â”‚  âš ï¸ Manager approval required for releasing product        â”‚
â”‚     after violation.                                       â”‚
â”‚                                                             â”‚
â”‚  [â—€ Back]                          [Next: Photo Evidence â–¶] â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Data Model:**

```json
{
  "corrective_action": {
    "corrective_action_id": "uuid",
    "monitoring_record_id": "uuid (FK, the violation that triggered this CA)",
    "plan_id": "uuid (FK)",
    "ccp_id": "uuid (FK)",
    "facility_id": "uuid",

    "violation_details": {
      "parameter": "string (e.g., 'Temperature')",
      "critical_limit": "string (e.g., 'â‰¤ 0Â°F')",
      "actual_value": "float (e.g., 15.0)",
      "deviation_amount": "float (e.g., 15.0)",
      "unit": "string (e.g., 'Â°F')",
      "severity": "enum[low, medium, high, critical]"
    },

    "initiated_by": "user_id",
    "initiated_at": "timestamp",
    "status": "enum[draft, pending_approval, approved, rejected, completed]",

    "root_cause": {
      "primary_cause": "enum[equipment_failure, human_error, process_deviation, environmental, unknown, other]",
      "detailed_cause": "text",
      "contributing_factors": ["array of strings"]
    },

    "actions_taken": [
      {
        "action_id": "uuid",
        "action_description": "text",
        "is_predefined": "boolean (from HACCP plan or custom)",
        "completed_at": "timestamp",
        "completed_by": "user_id"
      }
    ],

    "product_disposition": {
      "disposition_type": "enum[discarded, reworked, released, on_hold]",
      "justification": "text",
      "batch_lot_numbers": ["array of lot/batch IDs"],
      "quantity_affected": "string",
      "unit_of_measure": "string"
    },

    "evidence": {
      "photos": ["array of media_ids"],
      "videos": ["array of media_ids"],
      "documents": ["array of document URLs"]
    },

    "approval_workflow": {
      "requires_approval": "boolean",
      "approver_assigned": "user_id (nullable)",
      "approved_by": "user_id (nullable)",
      "approved_at": "timestamp (nullable)",
      "approval_decision": "enum[approved, rejected, request_changes] (nullable)",
      "approval_comments": "text (nullable)"
    },

    "verification": {
      "verification_required": "boolean",
      "verified_by": "user_id (nullable)",
      "verified_at": "timestamp (nullable)",
      "verification_method": "text (nullable, e.g., 'Re-checked temp after 30 min')",
      "verification_result": "text (nullable)"
    },

    "follow_up": {
      "preventive_actions_required": "boolean",
      "preventive_actions": ["array of action descriptions"],
      "training_needed": "boolean",
      "equipment_maintenance_required": "boolean",
      "haccp_plan_update_needed": "boolean"
    },

    "completed_at": "timestamp (nullable)",
    "time_to_complete_minutes": "integer (calculated)"
  }
}
```

---

#### Feature F3.2: Manager Approval & Verification Workflow

**Description:**
Multi-tier approval system ensuring corrective actions are reviewed and verified by supervisors before closure. Managers receive real-time notifications of corrective actions, can approve/reject with comments, and request additional actions if needed. Includes escalation to QA Manager for high-severity violations.

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| **Receive Approval Request** | Manager notified of pending corrective action | Push notification: "Corrective Action needs your approval - Freezer #3" | Manager taps notification; app opens CA review screen |
| **Review Corrective Action** | Manager evaluates if actions taken are sufficient | Reviews: Root cause, actions taken, photos, product disposition | System shows: Violation details, timestamps, evidence photos |
| **Approve Corrective Action** | Manager confirms actions are adequate | Taps "Approve"; optionally adds comments | System marks CA as "Approved"; notifies floor staff; closes incident |
| **Reject Corrective Action** | Manager determines additional action needed | Taps "Reject"; enters required changes: "Need to verify product temp again in 30 min" | System sends rejection back to floor staff with instructions; CA remains open |
| **Escalate to QA Manager** | High-severity violations escalate automatically | (Automatic if severity = "critical" or product released despite violation) | System sends notification to QA Manager; requires dual approval (Supervisor + QA) |
| **Verify Effectiveness** | Manager confirms corrective action resolved issue | After 1-24 hours, manager checks if issue recurred | If effective: Marks "Verified Effective"; If recurring: Opens new investigation |

**User Interface:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”” Pending Approvals (3)                  ğŸ‘¤ Sarah (Manager)â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ ğŸš¨ HIGH PRIORITY                             â”‚         â”‚
â”‚  â”‚ Corrective Action #CA-2024-1208-003         â”‚         â”‚
â”‚  â”‚                                              â”‚         â”‚
â”‚  â”‚ CCP 2: Cold Holding - Freezer #3            â”‚         â”‚
â”‚  â”‚ Violation: 15Â°F (Limit: â‰¤ 0Â°F)              â”‚         â”‚
â”‚  â”‚ Initiated: 10:15 AM by Maria Rodriguez      â”‚         â”‚
â”‚  â”‚ Status: â³ Pending Your Approval             â”‚         â”‚
â”‚  â”‚                                              â”‚         â”‚
â”‚  â”‚ Root Cause: Door left open during stocking  â”‚         â”‚
â”‚  â”‚ Actions: Closed door, checked product temp  â”‚         â”‚
â”‚  â”‚ Product: Released (50 lbs, safe at 10Â°F)    â”‚         â”‚
â”‚  â”‚                                              â”‚         â”‚
â”‚  â”‚ ğŸ“¸ Evidence: 2 photos attached               â”‚         â”‚
â”‚  â”‚                                              â”‚         â”‚
â”‚  â”‚ [ğŸ‘ï¸ Review Full Details]                    â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ Corrective Action #CA-2024-1208-002         â”‚         â”‚
â”‚  â”‚ CCP 1: Cooking - Oven #1                    â”‚         â”‚
â”‚  â”‚ Initiated: 9:45 AM by John Smith            â”‚         â”‚
â”‚  â”‚ [ğŸ‘ï¸ Review]                                 â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Corrective Action Review - CA-2024-1208-003                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ğŸ“‹ VIOLATION DETAILS                                      â”‚
â”‚  CCP 2: Cold Holding - Freezer #3                         â”‚
â”‚  Critical Limit: â‰¤ 0Â°F (-18Â°C)                             â”‚
â”‚  Actual Reading: 15Â°F                                      â”‚
â”‚  Deviation: +15Â°F OVER LIMIT                               â”‚
â”‚  Detected: Dec 8, 2024 10:15 AM                            â”‚
â”‚  By: Maria Rodriguez (Floor Staff)                         â”‚
â”‚                                                             â”‚
â”‚  ğŸ“ ROOT CAUSE                                             â”‚
â”‚  Primary: Door left open/not sealed                        â”‚
â”‚  Details: Door was accidentally left open during           â”‚
â”‚  stocking. Closed immediately. Duration <5 minutes.        â”‚
â”‚                                                             â”‚
â”‚  âœ… ACTIONS TAKEN                                          â”‚
â”‚  â€¢ Closed freezer door immediately (10:15 AM)              â”‚
â”‚  â€¢ Checked product temp: 10Â°F (safe, <41Â°F limit)         â”‚
â”‚  â€¢ Verified door seal is intact (no damage)                â”‚
â”‚                                                             â”‚
â”‚  ğŸ– PRODUCT DISPOSITION                                    â”‚
â”‚  Decision: âœ… Released (Product is Safe)                   â”‚
â”‚  Justification: Product temp 10Â°F (well below danger       â”‚
â”‚  zone). Door open <5 min. No safety risk.                 â”‚
â”‚  Batch: LOT-2024-1208-A                                    â”‚
â”‚  Quantity: 50 lbs                                          â”‚
â”‚                                                             â”‚
â”‚  ğŸ“¸ EVIDENCE (2 photos)                                    â”‚
â”‚  [Photo 1: Thermometer showing 15Â°F]                      â”‚
â”‚  [Photo 2: Product temp probe showing 10Â°F]               â”‚
â”‚                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                â”‚
â”‚                                                             â”‚
â”‚  ğŸ’¬ Manager Comments (optional):                           â”‚
â”‚  [Approved. Good catch. Remind staff to double-check       â”‚
â”‚   door closure after stocking.]                            â”‚
â”‚                                                             â”‚
â”‚  [âŒ Reject (Request Changes)]  [âœ… Approve Corrective Action]â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Data Model:**

```json
{
  "approval_log": {
    "approval_log_id": "uuid",
    "corrective_action_id": "uuid (FK)",
    "approver_type": "enum[shift_supervisor, qa_manager, facility_manager]",
    "approver_id": "user_id",
    "approval_tier": "integer (1 = first approval, 2 = escalated approval)",

    "notification_sent_at": "timestamp",
    "notification_read_at": "timestamp (nullable)",
    "reviewed_at": "timestamp (nullable)",
    "decision_at": "timestamp (nullable)",

    "decision": "enum[approved, rejected, request_changes, escalated]",
    "comments": "text",

    "requested_changes": [
      {
        "change_request": "text",
        "completed": "boolean",
        "completed_at": "timestamp (nullable)"
      }
    ],

    "escalation_reason": "text (nullable, if decision = escalated)"
  }
}
```

---

#### Feature F3.3: Root Cause Analysis & Trending

**Description:**

AI-powered root cause analysis tool that helps identify underlying systemic issues causing repeated violations. Analyzes patterns across corrective actions to surface recurring problems (equipment failures, supplier issues, training gaps, process weaknesses).

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| View Corrective Action Trends | QA manager reviews patterns over time | Opens "Corrective Actions" â†’ "Trends" | Shows chart: violations by CCP, category, root cause over 30/60/90 days |
| Identify Recurring Issue | System detects pattern (same equipment failing repeatedly) | (Automatic) 3+ violations on same equipment in 30 days | Alert: "ğŸš¨ Recurring Issue Detected: Walk-in Freezer #2 (4 violations in 30 days)" |
| Run Root Cause Analysis | Manager investigates why Freezer #2 keeps failing | Taps alert â†’ "Analyze Root Cause" | AI analyzes 4 violations; suggests: "Pattern: Door seal failures. Possible causes: Worn seal, incorrect closing procedure, high foot traffic" |
| Assign Investigation | Manager assigns maintenance to investigate | Selects "Assign Investigation" â†’ Maintenance Manager | Notification sent; investigation task created |
| Document Findings | Maintenance reviews equipment | Inspects freezer; takes photos; enters findings: "Door seal worn; needs replacement" | Findings logged; linked to original violations |
| Implement Preventive Action | Manager schedules seal replacement | Creates work order: "Replace Freezer #2 door seal by Dec 15" | Work order created; tracked until completion |
| Mark Issue Resolved | Seal replaced; violations stop | Marks work order complete; monitors for 30 days | System monitors; if no new violations, flags issue as "âœ… Resolved" |

**User Interface:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ CORRECTIVE ACTION TRENDS â”€â”€â”€â”€â”
â”‚                                                            â”‚
â”‚  ğŸ“Š Violations by CCP (Last 30 Days)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ CCP-2: Cooking Temp    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 8 violations       â”‚   â”‚
â”‚  â”‚ CCP-1: Receiving Temp  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 5 violations          â”‚   â”‚
â”‚  â”‚ CCP-3: Cooling         â–ˆâ–ˆâ–ˆ 3 violations            â”‚   â”‚
â”‚  â”‚ CCP-4: Cold Storage    â–ˆâ–ˆ 2 violations             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                            â”‚
â”‚  ğŸš¨ RECURRING ISSUES DETECTED                              â”‚
â”‚                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ§Š Walk-in Freezer #2 (CCP-4)                      â”‚   â”‚
â”‚  â”‚ 4 violations in 30 days                             â”‚   â”‚
â”‚  â”‚ Pattern: Door left open / not sealed                â”‚   â”‚
â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚ Root Cause (AI Analysis):                           â”‚   â”‚
â”‚  â”‚ â€¢ Door seal appears worn (3 of 4 violations)       â”‚   â”‚
â”‚  â”‚ â€¢ High foot traffic area (stocking 6x/day)         â”‚   â”‚
â”‚  â”‚ â€¢ Staff may not be fully closing door              â”‚   â”‚
â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚ Recommended Actions:                                 â”‚   â”‚
â”‚  â”‚ â˜‘ Inspect/replace door seal                        â”‚   â”‚
â”‚  â”‚ â˜‘ Retrain staff on proper door closure             â”‚   â”‚
â”‚  â”‚ â˜‘ Install door alarm (alerts if open >2 min)      â”‚   â”‚
â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚ [Assign Investigation] [Create Work Order]          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ¥© Ground Beef Supplier (CCP-1)                    â”‚   â”‚
â”‚  â”‚ 3 violations in 60 days                             â”‚   â”‚
â”‚  â”‚ Pattern: Product arrives above 41Â°F                â”‚   â”‚
â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚ Root Cause (AI Analysis):                           â”‚   â”‚
â”‚  â”‚ â€¢ Supplier's refrigerated truck may be faulty      â”‚   â”‚
â”‚  â”‚ â€¢ Long delivery times (4+ hours)                   â”‚   â”‚
â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚ Recommended Actions:                                 â”‚   â”‚
â”‚  â”‚ â˜‘ Contact supplier; require temp logs              â”‚   â”‚
â”‚  â”‚ â˜‘ Audit supplier's cold chain                      â”‚   â”‚
â”‚  â”‚ â˜‘ Consider alternate supplier                      â”‚   â”‚
â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚ [Contact Supplier] [Schedule Audit]                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Data Model:**

```json
{
  "root_cause_analysis": {
    "analysis_id": "uuid",
    "triggered_by": "enum[manual_request, automatic_threshold]",
    "trigger_threshold": "integer (e.g., 3 violations in 30 days)",

    "scope": {
      "ccp_id": "uuid (nullable, if analyzing specific CCP)",
      "equipment_id": "uuid (nullable, if analyzing specific equipment)",
      "supplier_id": "uuid (nullable, if analyzing supplier issues)",
      "date_range": {
        "start_date": "date",
        "end_date": "date"
      }
    },

    "related_violations": [
      "array of corrective_action_ids (violations included in analysis)"
    ],

    "ai_findings": {
      "pattern_detected": "string (e.g., 'Door seal failures')",
      "possible_root_causes": [
        {
          "cause": "string (e.g., 'Worn door seal')",
          "confidence": "float (0.0-1.0, AI confidence score)",
          "evidence": ["array of strings - evidence supporting this cause"]
        }
      ],
      "recommended_actions": [
        {
          "action": "string (e.g., 'Replace door seal')",
          "priority": "enum[high, medium, low]",
          "estimated_cost": "float (nullable)",
          "expected_impact": "string (e.g., 'Should eliminate 80% of violations')"
        }
      ]
    },

    "investigation": {
      "status": "enum[not_started, in_progress, completed]",
      "assigned_to": "user_id (nullable)",
      "assigned_at": "timestamp (nullable)",
      "findings": "text (nullable, actual findings from investigation)",
      "photos": ["array of photo objects (nullable)"]
    },

    "resolution": {
      "preventive_action_id": "uuid (nullable, FK to preventive_action if created)",
      "resolved_at": "timestamp (nullable)",
      "resolution_notes": "text (nullable)"
    }
  }
}
```

---

#### Feature F3.4: Preventive Action Recommendations

**Description:**

Proactive system that monitors compliance patterns and suggests preventive actions BEFORE violations occur. Uses AI to identify "early warning signals" (e.g., temperatures creeping toward critical limits, equipment showing signs of wear, staff compliance declining).

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| Monitor for Early Warning Signals | System tracks measurements trending toward limits | (Automatic) Daily analysis | Analyzes 7-day trend: "Walk-in cooler temps averaging 38Â°F (limit: 41Â°F); creeping upward" |
| Generate Preventive Alert | System detects potential future violation | (Automatic) Trend detected | Alert: "âš ï¸ Preventive Alert: Walk-in Cooler CCP-4 trending toward limit" |
| Review Preventive Alert | QA manager reviews recommendation | Opens alert | Shows: Current trend, predicted violation date, recommended preventive actions |
| Accept Recommendation | Manager agrees with recommendation | Taps "Create Preventive Action" | Work order created; assigned to maintenance; tracked until completion |
| Reject Recommendation | Manager disagrees (false positive) | Taps "Dismiss" â†’ Reason: "Equipment recently serviced; trend is normal seasonal variation" | Alert dismissed; AI learns from feedback |
| Track Preventive Action | Maintenance performs action | Updates work order: "Cleaned condenser coils; temps now stable at 35Â°F" | Action logged; system monitors for 14 days to confirm issue resolved |

**User Interface:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ PREVENTIVE ACTION DASHBOARD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                            â”‚
â”‚  âš ï¸ EARLY WARNING SIGNALS (3 Active)                      â”‚
â”‚                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ§Š Walk-in Cooler CCP-4 (High Priority)            â”‚   â”‚
â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚ ğŸ“ˆ Trend Analysis:                                  â”‚   â”‚
â”‚  â”‚ Temperature creeping upward over 7 days              â”‚   â”‚
â”‚  â”‚ Dec 1: 35Â°F â†’ Dec 8: 38Â°F (limit: 41Â°F)            â”‚   â”‚
â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚ ğŸ”® Prediction:                                       â”‚   â”‚
â”‚  â”‚ Likely to exceed limit by: Dec 22 (14 days)         â”‚   â”‚
â”‚  â”‚ Confidence: 78%                                      â”‚   â”‚
â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚ ğŸ’¡ Recommended Preventive Actions:                   â”‚   â”‚
â”‚  â”‚ 1. Clean condenser coils (likely cause)            â”‚   â”‚
â”‚  â”‚ 2. Check refrigerant levels                         â”‚   â”‚
â”‚  â”‚ 3. Inspect door seals                               â”‚   â”‚
â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚ [Create Work Order] [Dismiss Alert]                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ‘¤ Staff Compliance: John Doe (Medium Priority)    â”‚   â”‚
â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚ ğŸ“Š Compliance Trend:                                â”‚   â”‚
â”‚  â”‚ On-time monitoring completion declining              â”‚   â”‚
â”‚  â”‚ Nov: 98% â†’ Dec: 89% (target: 95%)                  â”‚   â”‚
â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚ ğŸ’¡ Recommended Actions:                              â”‚   â”‚
â”‚  â”‚ 1. One-on-one coaching session                      â”‚   â”‚
â”‚  â”‚ 2. Review task schedule (possible overload?)       â”‚   â”‚
â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚ [Schedule Coaching] [Review Schedule] [Dismiss]      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ”§ Oven #3 CCP-2 (Low Priority)                    â”‚   â”‚
â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚ ğŸ“ˆ Trend: Cooking times increasing slightly        â”‚   â”‚
â”‚  â”‚ Nov avg: 12 min â†’ Dec avg: 13.5 min                â”‚   â”‚
â”‚  â”‚ (May indicate heating element wearing out)          â”‚   â”‚
â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚ ğŸ’¡ Recommended: Schedule preventive maintenance      â”‚   â”‚
â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚ [Create Work Order] [Dismiss]                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Data Model:**

```json
{
  "preventive_action": {
    "preventive_action_id": "uuid",
    "alert_type": "enum[equipment_trend, staff_compliance, supplier_performance, process_drift]",
    "priority": "enum[high, medium, low]",

    "early_warning_signal": {
      "signal_detected": "string (e.g., 'Temperature creeping toward limit')",
      "current_measurement": "float",
      "critical_limit": "float",
      "distance_from_limit": "float (how close to violation)",
      "trend_direction": "enum[approaching_limit, stable, moving_away]",
      "trend_velocity": "float (rate of change per day)"
    },

    "prediction": {
      "predicted_violation_date": "date (nullable, if trend continues)",
      "confidence_score": "float (0.0-1.0, AI confidence)",
      "prediction_basis": "text (explanation of how prediction was made)"
    },

    "recommendations": [
      {
        "recommendation": "string (e.g., 'Clean condenser coils')",
        "rationale": "string (why this action will help)",
        "estimated_cost": "float (nullable)",
        "estimated_time": "string (nullable, e.g., '2 hours')"
      }
    ],

    "response": {
      "status": "enum[pending_review, accepted, dismissed, in_progress, completed]",
      "reviewed_by": "user_id (nullable)",
      "reviewed_at": "timestamp (nullable)",
      "decision": "enum[accept, dismiss] (nullable)",
      "dismissal_reason": "text (nullable, if dismissed)",
      "work_order_id": "uuid (nullable, FK to work order if accepted)",
      "completed_at": "timestamp (nullable)"
    },

    "outcome_tracking": {
      "issue_resolved": "boolean (nullable, determined after 14-day monitoring)",
      "actual_impact": "text (nullable, what happened after action was taken)",
      "ai_feedback": "boolean (was the recommendation helpful? Used to improve AI)"
    }
  }
}
```

---

### 3.6 Module 3 Data Models Summary

**Core Entities:**

1. **corrective_action** - Main record capturing HACCP violation and response
2. **approval_log** - Multi-tier manager approval workflow
3. **root_cause_analysis** - AI-powered pattern detection and systemic issue identification
4. **preventive_action** - Proactive alerts and recommendations to prevent future violations

**Key Relationships:**

- `corrective_action` â†’ `monitoring_record` (1:1, which monitoring event triggered this?)
- `corrective_action` â†’ `approval_log` (1:N, multi-tier approvals)
- `root_cause_analysis` â†’ `corrective_action` (1:N, analyzes multiple violations)
- `preventive_action` â†’ `work_order` (1:1, if recommendation accepted)

---

## 4. Module 4: Audit & Reporting

### 4.1 Module Overview

**Purpose:** Enable facilities to pass regulatory audits with ZERO preparation time through one-click audit report generation, real-time compliance dashboards, and AI-powered trend analysis that surfaces issues BEFORE auditors arrive.

**Target Users:**
- QA Managers (generating audit reports)
- Facility Managers (compliance oversight)
- Corporate leadership (multi-site visibility)
- Auditors (read-only access to records)

**Key Capabilities:**

1. **One-Click Audit Reports** - Generate print-ready HACCP audit reports in 30 seconds (vs. 2-4 weeks manual compilation)
2. **Compliance Dashboard** - Real-time visibility into HACCP compliance status across all CCPs
3. **Trend Analysis** - AI-powered insights identifying compliance patterns and risks
4. **Custom Report Builder** - Flexible reporting for internal reviews, customer audits, insurance

**Competitive Edge:**

- vs. SafetyChain: "Same analytics power, 10x faster report generation"
- vs. FoodDocs: "Enterprise-grade reporting at SMB price"
- vs. Paper-based: "2-week audit prep â†’ 30 seconds"

---

#### Feature F4.1: One-Click Audit Report Generation

**Description:**

Automated audit report generator that compiles HACCP plan, monitoring records, corrective actions, training records, and supplier documentation into a print-ready PDF in 30 seconds. Supports FDA, USDA, GFSI, SQF, BRC, HACCP Alliance, and ISO 22000 formats.

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| Select Audit Type | QA manager chooses regulatory framework | Opens "Audit Reports" â†’ Selects "FDA Retail Audit" | System loads FDA-specific report template |
| Define Date Range | Manager selects audit period | Selects date range: "Jan 1 - Dec 31, 2024" | System queries all records in range |
| Select Scope | Choose which CCPs/products to include | Selects "All CCPs" (or specific CCPs if partial audit) | Scope confirmed |
| Generate Report | System compiles all documentation | Taps "Generate Report" | Progress bar: "Compiling monitoring records... (3 sec) â†’ Analyzing corrective actions... (2 sec) â†’ Generating PDF... (1 sec)" |
| Preview Report | Manager reviews before printing | PDF preview appears (auto-paginated, branded) | Displays 87-page report with table of contents, all data organized by CCP |
| Download/Print | Export report for auditor | Taps "Download PDF" or "Print" | PDF downloaded; ready for auditor |
| Share with Auditor | Grant read-only access to auditor | Taps "Share" â†’ Enters auditor email: auditor@agency.gov | Auditor receives secure link; can browse records online (no download/edit rights) |

**User Interface:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ GENERATE AUDIT REPORT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                            â”‚
â”‚  ğŸ“‹ Report Type:                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â— FDA Retail Food Audit (2017 Food Code)          â”‚   â”‚
â”‚  â”‚ â—‹ USDA HACCP Verification                          â”‚   â”‚
â”‚  â”‚ â—‹ SQF Food Safety Code (Edition 9)                â”‚   â”‚
â”‚  â”‚ â—‹ BRC Global Standard (Issue 9)                   â”‚   â”‚
â”‚  â”‚ â—‹ ISO 22000:2018                                   â”‚   â”‚
â”‚  â”‚ â—‹ Custom Report                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                            â”‚
â”‚  ğŸ“… Date Range:                                           â”‚
â”‚  From: [Jan 1, 2024  â–¼]  To: [Dec 31, 2024  â–¼]          â”‚
â”‚                                                            â”‚
â”‚  ğŸ¯ Scope:                                                â”‚
â”‚  â˜‘ All Critical Control Points (7 CCPs)                  â”‚
â”‚  â˜‘ All Monitoring Records (2,847 records)                â”‚
â”‚  â˜‘ All Corrective Actions (23 violations)                â”‚
â”‚  â˜‘ Training Records (12 employees)                       â”‚
â”‚  â˜‘ Supplier Documentation (8 suppliers)                  â”‚
â”‚  â˜‘ Equipment Calibration Logs (15 thermometers)          â”‚
â”‚                                                            â”‚
â”‚  ğŸ“„ Report Options:                                       â”‚
â”‚  â˜‘ Include photos (evidence from corrective actions)     â”‚
â”‚  â˜‘ Include trend charts (compliance over time)           â”‚
â”‚  â˜‘ Include employee signatures (digital signatures)      â”‚
â”‚  â˜ Anonymize employee names (use IDs only)               â”‚
â”‚                                                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚
â”‚                                                            â”‚
â”‚  [Cancel]              [Generate Report (Estimated: 30s)] â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

(After clicking "Generate Report"):

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ GENERATING REPORT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                            â”‚
â”‚  â³ Compiling Audit Report...                             â”‚
â”‚                                                            â”‚
â”‚  âœ… Loading HACCP Plan (CCP definitions, critical limits) â”‚
â”‚  âœ… Compiling monitoring records (2,847 records)          â”‚
â”‚  âœ… Analyzing corrective actions (23 violations)          â”‚
â”‚  ğŸ”„ Generating trend charts...                            â”‚
â”‚  â¸ Formatting PDF (87 pages)...                          â”‚
â”‚                                                            â”‚
â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 80%                                 â”‚
â”‚                                                            â”‚
â”‚  Estimated time remaining: 5 seconds                       â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

(After completion):

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ AUDIT REPORT READY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                            â”‚
â”‚  âœ… Report Generated Successfully!                        â”‚
â”‚                                                            â”‚
â”‚  ğŸ“„ FDA Retail Food Audit Report                          â”‚
â”‚  Facility: Artisan Bakery & Cafe                          â”‚
â”‚  Period: Jan 1 - Dec 31, 2024                             â”‚
â”‚  Pages: 87                                                 â”‚
â”‚  Generated: Dec 8, 2024 3:42 PM                           â”‚
â”‚                                                            â”‚
â”‚  ğŸ“Š Summary:                                              â”‚
â”‚  â€¢ 2,847 monitoring records (100% compliance)             â”‚
â”‚  â€¢ 23 corrective actions (all resolved within 24 hours)  â”‚
â”‚  â€¢ 0 critical violations                                  â”‚
â”‚  â€¢ 12 employees trained (100% up-to-date)                â”‚
â”‚  â€¢ 8 suppliers (all approved, documentation current)      â”‚
â”‚                                                            â”‚
â”‚  [ğŸ“± Preview PDF]  [â¬‡ï¸ Download]  [ğŸ–¨ Print]  [ğŸ“§ Share] â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Data Model:**

```json
{
  "audit_report": {
    "report_id": "uuid",
    "report_type": "enum[fda_retail, usda_haccp, sqf, brc, iso22000, custom]",
    "facility_id": "uuid (FK)",

    "scope": {
      "date_range": {
        "start_date": "date",
        "end_date": "date"
      },
      "ccp_ids": ["array of uuids (which CCPs to include)"],
      "include_monitoring_records": "boolean",
      "include_corrective_actions": "boolean",
      "include_training_records": "boolean",
      "include_supplier_docs": "boolean",
      "include_calibration_logs": "boolean"
    },

    "report_options": {
      "include_photos": "boolean",
      "include_trend_charts": "boolean",
      "include_signatures": "boolean",
      "anonymize_employees": "boolean"
    },

    "generation": {
      "generated_by": "user_id",
      "generated_at": "timestamp",
      "generation_time_seconds": "float (time taken to generate)",
      "status": "enum[generating, completed, failed]"
    },

    "output": {
      "pdf_url": "string (S3 URL to generated PDF)",
      "file_size_mb": "float",
      "page_count": "integer",
      "table_of_contents": [
        {
          "section": "string (e.g., 'Executive Summary')",
          "page_number": "integer"
        }
      ]
    },

    "summary_statistics": {
      "total_monitoring_records": "integer",
      "compliance_rate": "float (percentage)",
      "total_corrective_actions": "integer",
      "critical_violations": "integer",
      "employees_trained": "integer",
      "suppliers_approved": "integer"
    },

    "sharing": {
      "shared_with": [
        {
          "recipient_email": "string",
          "access_granted_at": "timestamp",
          "access_expires_at": "timestamp (nullable)",
          "access_token": "string (secure token for read-only link)",
          "access_revoked": "boolean"
        }
      ]
    }
  }
}
```

---

#### Feature F4.2: Compliance Dashboard & Analytics

**Description:**

Real-time compliance dashboard providing at-a-glance visibility into HACCP program health. Shows compliance rates by CCP, recent violations, overdue monitoring tasks, and staff performance.

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| View Dashboard | Manager checks compliance status | Opens app â†’ "Dashboard" | Displays compliance score (98%), violations (2), overdue tasks (0) |
| Drill Down by CCP | Investigate CCP performance | Taps "CCP-2: Cooking Temp" | Shows detailed view with trend chart |
| Review Staff Performance | Check employee compliance | Taps "Staff Performance" | Shows leaderboard |

**Data Model:**

```json
{
  "dashboard_snapshot": {
    "snapshot_id": "uuid",
    "facility_id": "uuid (FK)",
    "overall_compliance": {
      "compliance_rate": "float",
      "total_monitoring_records": "integer",
      "violations": "integer"
    },
    "ccp_compliance": [
      {
        "ccp_id": "uuid",
        "compliance_rate": "float",
        "violations": "integer"
      }
    ]
  }
}
```

---

#### Feature F4.3: Trend Analysis & Predictive Insights

**Description:**

AI-powered analytics identifying compliance trends, seasonal patterns, and emerging risks with predictive forecasting.

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| View Trends | Review historical performance | Opens "Analytics" â†’ "Trends" | Shows 12-month compliance chart |
| Identify Patterns | Detect seasonal issues | (Automatic) Analyzes data | Alert: "Cooling violations spike in summer" |
| View Forecast | See future projections | Taps "Forecast" | AI predicts 99% compliance by Q1 2025 |

**Data Model:**

```json
{
  "trend_analysis": {
    "analysis_id": "uuid",
    "facility_id": "uuid (FK)",
    "time_series_data": [
      {
        "period": "string",
        "compliance_rate": "float",
        "violations": "integer"
      }
    ],
    "seasonal_patterns": [
      {
        "pattern_detected": "string",
        "recommended_action": "string"
      }
    ],
    "predictive_forecast": {
      "predicted_compliance_rate": "float",
      "confidence_score": "float"
    }
  }
}
```

---

#### Feature F4.4: Custom Report Builder

**Description:**

Drag-and-drop report builder for creating custom HACCP reports for internal reviews, customer audits, insurance, or corporate leadership.

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| Create Report | Build custom report | Opens "Reports" â†’ "Create Custom" | Report builder loads |
| Select Data Sources | Choose data to include | Checks boxes: Monitoring, Corrective Actions | Data sources selected |
| Add Visualizations | Choose charts | Drags components to canvas | Chart appears in preview |
| Schedule Recurring | Automate report generation | Sets "Monthly on 1st" â†’ Recipients | Scheduled; auto-emails monthly |

**Data Model:**

```json
{
  "custom_report": {
    "report_id": "uuid",
    "report_name": "string",
    "data_sources": {
      "include_monitoring_records": "boolean",
      "include_corrective_actions": "boolean"
    },
    "components": [
      {
        "component_type": "enum[executive_summary, scorecard, trend_chart, violations_table]",
        "order": "integer"
      }
    ],
    "scheduling": {
      "is_recurring": "boolean",
      "recurrence_pattern": "enum[daily, weekly, monthly, quarterly]",
      "recipients": ["array of emails"]
    }
  }
}
```

---

### 4.6 Module 4 Data Models Summary

**Core Entities:**

1. **audit_report** - One-click regulatory audit reports
2. **dashboard_snapshot** - Real-time compliance dashboard
3. **trend_analysis** - AI-powered trend detection and forecasting
4. **custom_report** - User-built custom reports

---

## 5. Module 5: Multi-Location Management

### 5.1 Module Overview

**Purpose:** Enable franchise owners and corporate QA teams to manage HACCP compliance across 10-1000+ locations from a single command center.

**Target Users:**
- Franchise Owners (2-50 locations)
- Corporate QA Directors (50-500 locations)
- Regional Managers (5-20 locations)
- Brand Protection Teams

**Key Capabilities:**

1. **Franchise Command Center** - Real-time visibility across all locations
2. **Location Ranking & Scorecards** - Identify top performers and at-risk locations
3. **Cross-Location Comparison** - Benchmark performance
4. **Brand Protection** - Early warning system for compliance failures

---

#### Feature F5.1: Franchise Command Center Dashboard

**Description:**

Centralized dashboard providing real-time HACCP compliance visibility across all locations with map view, aggregate metrics, and at-risk alerts.

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| View All Locations | See network-wide compliance | Opens "Command Center" | Map shows 47 locations color-coded by compliance |
| Identify At-Risk | Find locations needing attention | Taps "At-Risk Locations" | Lists 2 locations: "Brooklyn #423 (78% compliance)" |
| Drill Down | Investigate specific facility | Taps location | Opens location-specific dashboard |
| Send Alert | Notify location manager | Taps "Send Alert" â†’ Message | Push notification sent to manager |

**Data Model:**

```json
{
  "command_center_dashboard": {
    "dashboard_id": "uuid",
    "organization_id": "uuid (FK)",
    "aggregate_metrics": {
      "total_locations": "integer",
      "average_compliance_rate": "float",
      "total_active_violations": "integer"
    },
    "location_status": [
      {
        "facility_id": "uuid",
        "compliance_rate": "float",
        "status": "enum[excellent, good, at_risk, critical]",
        "active_violations": "integer"
      }
    ]
  }
}
```

---

#### Feature F5.2: Location Ranking & Scorecards

**Description:**

Gamified leaderboard ranking all locations by compliance performance with detailed scorecards showing strengths and weaknesses.

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| View Rankings | See location leaderboard | Opens "Rankings" | Shows 47 locations ranked by compliance score |
| Filter by Region | Focus on specific area | Selects "Northeast" | Shows 12 Northeast locations ranked |
| View Scorecard | See detailed performance | Taps location | Shows scorecard with CCP-level breakdown |
| Share Best Practices | Learn from top performers | Taps "Share Best Practices" | Creates report highlighting #1 location's strategies |

**Data Model:**

```json
{
  "location_scorecard": {
    "scorecard_id": "uuid",
    "facility_id": "uuid (FK)",
    "overall_score": "float (0-100)",
    "rank": "integer",
    "ccp_scores": [
      {
        "ccp_id": "uuid",
        "score": "float",
        "strength_or_weakness": "enum[strength, weakness]"
      }
    ],
    "best_practices": ["array of strings"]
  }
}
```

---

#### Feature F5.3: Cross-Location Compliance Comparison

**Description:**

Side-by-side comparison tool to benchmark location performance, identify outliers, and replicate successful strategies across the network.

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| Select Locations to Compare | Choose facilities | Selects 3 locations | Comparison table loads |
| View Side-by-Side | See performance differences | Views table | Shows CCP compliance rates side-by-side |
| Identify Outliers | Find unusual patterns | System highlights outliers | "Brooklyn #423 has 3x more cooling violations than network average" |
| Export Comparison | Share with leadership | Taps "Export" | Generates PDF comparison report |

**Data Model:**

```json
{
  "location_comparison": {
    "comparison_id": "uuid",
    "facility_ids": ["array of uuids being compared"],
    "comparison_metrics": [
      {
        "metric_name": "string",
        "facility_values": [
          {
            "facility_id": "uuid",
            "value": "float",
            "variance_from_avg": "float"
          }
        ]
      }
    ]
  }
}
```

---

#### Feature F5.4: Brand Protection & Risk Management

**Description:**

Early warning system for compliance failures that could lead to foodborne illness outbreaks, regulatory violations, or brand damage. Escalates critical issues to corporate immediately.

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| Monitor Critical Events | Track high-risk violations | (Automatic) Real-time monitoring | Detects critical violation at Location #423 |
| Escalate to Corporate | Alert leadership immediately | (Automatic) Critical threshold exceeded | SMS/email sent to VP of QA within 1 minute |
| Initiate Response Protocol | Execute crisis plan | Corporate taps "Initiate Response" | Creates incident response task force |
| Track Resolution | Monitor corrective actions | Views incident dashboard | Shows timeline: violation detected â†’ escalated â†’ resolved |

**Data Model:**

```json
{
  "brand_protection_alert": {
    "alert_id": "uuid",
    "facility_id": "uuid (FK)",
    "alert_type": "enum[critical_violation, outbreak_risk, regulatory_notice, repeat_offender]",
    "severity": "enum[high, critical]",
    "escalation": {
      "escalated_to": ["array of user_ids (corporate leadership)"],
      "escalated_at": "timestamp",
      "notification_channels": ["enum values: sms, email, push, phone_call"]
    },
    "response_protocol": {
      "protocol_initiated": "boolean",
      "incident_commander": "user_id",
      "response_actions": [
        {
          "action": "string",
          "assigned_to": "user_id",
          "status": "enum[pending, in_progress, completed]"
        }
      ]
    }
  }
}
```

---

### 5.5 Module 5 Data Models Summary

**Core Entities:**

1. **command_center_dashboard** - Multi-location overview
2. **location_scorecard** - Individual location performance scores
3. **location_comparison** - Side-by-side benchmarking
4. **brand_protection_alert** - Critical issue escalation

---

## 6. Module 6: Integration & IoT

### 6.1 Module Overview

**Purpose:** Connect HACCP platform with existing business systems (ERP, POS, CMMS) and IoT sensors for automated data capture, eliminating manual data entry.

**Target Users:**
- IT Managers (configuring integrations)
- QA Managers (automated monitoring)
- Operations Directors (unified data view)

**Key Capabilities:**

1. **Plug-and-Play IoT Sensor Kits** - Automated temperature monitoring
2. **ERP Integration** - Sync with QuickBooks, NetSuite, SAP, Odoo
3. **POS Integration** - Link to Toast, Square for traceability
4. **API & Webhooks** - Custom integrations

---

#### Feature F6.1: Plug-and-Play IoT Sensor Kits

**Description:**

Pre-configured wireless IoT temperature sensors that automatically capture and sync critical limit measurements to the HACCP platform, eliminating manual logging.

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| Pair Sensor | Connect sensor to system | Scans QR code on sensor | Sensor paired to CCP-4 (Walk-in Cooler) |
| Auto-Monitor | Sensor captures temp every 15 min | (Automatic) Sensor reads temp | Data synced to cloud; logged as monitoring record |
| Receive Violation Alert | Sensor detects out-of-range temp | (Automatic) Temp exceeds 41Â°F | Alert sent to manager + floor staff immediately |
| View Sensor Dashboard | Check all sensor status | Opens "IoT Sensors" | Shows 15 sensors; all online, battery levels |

**Data Model:**

```json
{
  "iot_sensor": {
    "sensor_id": "uuid",
    "sensor_type": "enum[temperature, humidity, pressure]",
    "facility_id": "uuid (FK)",
    "ccp_id": "uuid (FK, linked to specific CCP)",
    "location": "string (e.g., 'Walk-in Cooler #2')",
    "pairing": {
      "paired_at": "timestamp",
      "last_sync": "timestamp",
      "battery_level": "integer (percentage)",
      "connection_status": "enum[online, offline, low_battery]"
    },
    "monitoring_config": {
      "reading_interval_minutes": "integer (e.g., 15)",
      "critical_limit": "float",
      "alert_threshold": "float"
    }
  }
}
```

---

#### Feature F6.2: ERP Integration (QuickBooks, NetSuite, SAP, Odoo)

**Description:**

Bi-directional integration with ERP systems to sync supplier data, ingredient traceability, and production records.

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| Configure Integration | Connect to ERP | Enters ERP API credentials | Connection established; syncs supplier list |
| Sync Suppliers | Import approved supplier list | Taps "Sync Suppliers" | 47 suppliers imported from QuickBooks |
| Link Ingredients | Map ERP SKUs to HACCP products | Maps SKU-1234 to "Ground Beef" | Traceability link created |
| Auto-Create Receiving Records | ERP purchase order triggers HACCP task | (Automatic) PO received in ERP | HACCP receiving temp check task created automatically |

**Data Model:**

```json
{
  "erp_integration": {
    "integration_id": "uuid",
    "erp_system": "enum[quickbooks, netsuite, sap, odoo]",
    "facility_id": "uuid (FK)",
    "connection": {
      "api_endpoint": "string",
      "auth_token": "string (encrypted)",
      "last_sync": "timestamp",
      "sync_status": "enum[active, error, disconnected]"
    },
    "sync_config": {
      "sync_suppliers": "boolean",
      "sync_ingredients": "boolean",
      "sync_production_records": "boolean",
      "sync_frequency_minutes": "integer"
    }
  }
}
```

---

#### Feature F6.3: POS Integration (Toast, Square)

**Description:**

Integration with restaurant POS systems to link sales data with HACCP traceability for rapid recall management.

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| Connect POS | Link to Toast/Square | Enters POS API credentials | Connection established |
| Trace Product | Identify all sales of specific batch | Enters batch LOT-2024-1208-A | Shows: 127 burgers sold on Dec 8; customer receipts linked |
| Initiate Recall | Alert customers if contamination detected | Taps "Initiate Recall" | System identifies affected customers; sends recall notice |

**Data Model:**

```json
{
  "pos_integration": {
    "integration_id": "uuid",
    "pos_system": "enum[toast, square, clover, lightspeed]",
    "facility_id": "uuid (FK)",
    "traceability_link": [
      {
        "batch_id": "uuid (FK to production batch)",
        "sales_records": [
          {
            "sale_id": "string (POS transaction ID)",
            "sold_at": "timestamp",
            "customer_contact": "string (nullable, if loyalty program)"
          }
        ]
      }
    ]
  }
}
```

---

#### Feature F6.4: API & Webhooks

**Description:**

RESTful API and webhook system for custom integrations with CMMS, LIMS, quality systems, or proprietary business applications.

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| Generate API Key | Create credentials for integration | Opens "API" â†’ "Generate Key" | API key created; shows documentation link |
| Configure Webhook | Receive real-time events | Enters webhook URL; selects events | Webhook active; will POST on violation events |
| Test API | Verify integration works | Sends test API request | Returns sample HACCP plan data (JSON) |

**Data Model:**

```json
{
  "api_configuration": {
    "api_key_id": "uuid",
    "facility_id": "uuid (FK)",
    "api_key": "string (hashed)",
    "permissions": ["array of enum values: read_plans, write_monitoring, read_reports"],
    "rate_limit": "integer (requests per hour)",
    "webhook_url": "string (nullable)",
    "webhook_events": ["array of enum values: violation_created, corrective_action_approved"]
  }
}
```

---

### 6.5 Module 6 Data Models Summary

**Core Entities:**

1. **iot_sensor** - Wireless sensor configuration and data
2. **erp_integration** - ERP system connections
3. **pos_integration** - POS system links for traceability
4. **api_configuration** - API keys and webhook config

---

## 7. Module 7: Administration & Settings

### 7.1 Module Overview

**Purpose:** Centralized administration for user management, facility setup, notification configuration, and system preferences.

**Target Users:**
- Facility Administrators
- IT Managers
- System Administrators

**Key Capabilities:**

1. **User Management & RBAC** - Role-based access control
2. **Facility & Equipment Setup** - Configure locations, equipment, CCPs
3. **Notification Configuration** - Customize alerts
4. **System Settings** - Preferences and customization

---

#### Feature F7.1: User Management & Role-Based Access Control

**Description:**

Comprehensive user management with role-based permissions ensuring staff only access features relevant to their role.

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| Add User | Invite new employee | Enters email, name, role | Invitation email sent |
| Assign Role | Set permissions | Selects role: "Floor Staff" | User granted: monitoring, corrective actions (no admin access) |
| Deactivate User | Remove access | Taps "Deactivate" â†’ Confirms | User account disabled; no longer can log in |

**Roles:**

- **Floor Staff** - Monitor CCPs, submit corrective actions (read/write monitoring)
- **Shift Supervisor** - Approve corrective actions, view reports (approve CA, read reports)
- **QA Manager** - Full HACCP management (all permissions except user management)
- **Facility Administrator** - Full system access (all permissions)
- **Corporate Read-Only** - View-only access to all locations (read-only multi-location)

**Data Model:**

```json
{
  "user": {
    "user_id": "uuid",
    "email": "string",
    "name": "string",
    "role": "enum[floor_staff, shift_supervisor, qa_manager, facility_admin, corporate_readonly]",
    "permissions": [
      "enum values: read_plans, write_monitoring, approve_corrective_actions, generate_reports, manage_users, configure_integrations"
    ],
    "facilities_access": ["array of facility_ids (for multi-location users)"],
    "status": "enum[active, deactivated, pending_invitation]"
  }
}
```

---

#### Feature F7.2: Facility & Equipment Setup

**Description:**

Wizard-guided setup for configuring facility details, equipment list, and CCP definitions with QR code generation for equipment tagging.

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| Add Facility | Create new location | Enters: Name, Address, Contact | Facility created |
| Add Equipment | Register monitoring equipment | Enters: "Walk-in Cooler #2", Type: Refrigeration | Equipment created; QR code generated |
| Print QR Codes | Label equipment | Taps "Print QR Codes" | PDF with QR labels generated (print and affix to equipment) |
| Configure CCPs | Define critical control points | Enters CCP details via wizard | CCPs configured; monitoring tasks auto-created |

**Data Model:**

```json
{
  "facility_setup": {
    "facility_id": "uuid",
    "facility_name": "string",
    "address": "string",
    "contact_info": {
      "phone": "string",
      "email": "string"
    },
    "equipment": [
      {
        "equipment_id": "uuid",
        "equipment_name": "string",
        "equipment_type": "enum[refrigeration, cooking, cooling, storage]",
        "qr_code_url": "string (S3 URL to QR code image)"
      }
    ]
  }
}
```

---

#### Feature F7.3: Notification Configuration

**Description:**

Customizable notification settings controlling who receives alerts, when, and via which channels (push, SMS, email).

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| Configure Violation Alerts | Set who gets notified | Selects: "Critical violations â†’ SMS to QA Manager + Floor Staff" | Config saved |
| Set Quiet Hours | Disable non-critical alerts | Sets quiet hours: 10 PM - 6 AM | Non-critical alerts suppressed during hours |
| Test Notification | Verify alerts work | Taps "Send Test Alert" | Test notification sent to configured recipients |

**Data Model:**

```json
{
  "notification_config": {
    "config_id": "uuid",
    "facility_id": "uuid (FK)",
    "violation_alerts": {
      "critical_violations": {
        "recipients": ["array of user_ids"],
        "channels": ["enum values: push, sms, email"]
      },
      "minor_violations": {
        "recipients": ["array of user_ids"],
        "channels": ["enum values: push, email"]
      }
    },
    "quiet_hours": {
      "enabled": "boolean",
      "start_time": "time (e.g., '22:00')",
      "end_time": "time (e.g., '06:00')"
    }
  }
}
```

---

#### Feature F7.4: System Settings & Preferences

**Description:**

General system preferences including timezone, language, units (Fahrenheit/Celsius), and branding customization.

**Operations:**

| Operation | Description | User Action | System Response |
|-----------|-------------|-------------|-----------------|
| Set Timezone | Configure local time | Selects "America/New_York (EST)" | All timestamps displayed in EST |
| Choose Units | Temp scale preference | Selects "Fahrenheit" | All temps displayed as Â°F |
| Upload Logo | Brand customization | Uploads company logo | Logo appears on reports, login screen |
| Set Language | Multi-language support | Selects "Spanish" | UI switches to Spanish |

**Data Model:**

```json
{
  "system_settings": {
    "settings_id": "uuid",
    "facility_id": "uuid (FK)",
    "timezone": "string (e.g., 'America/New_York')",
    "language": "enum[english, spanish, french, chinese]",
    "units": {
      "temperature": "enum[fahrenheit, celsius]",
      "weight": "enum[pounds, kilograms]"
    },
    "branding": {
      "logo_url": "string (S3 URL, nullable)",
      "primary_color": "string (hex code)"
    }
  }
}
```

---

### 7.5 Module 7 Data Models Summary

**Core Entities:**

1. **user** - User accounts and role-based permissions
2. **facility_setup** - Facility and equipment configuration
3. **notification_config** - Alert routing and channels
4. **system_settings** - General preferences and branding

---

## 8. Appendices

### 8.1 Complete Entity Relationship Diagram

**Core Entity Relationships:**

```
organization (1) â”€â”€â”€â”€â”€â”€ (N) facility
facility (1) â”€â”€â”€â”€â”€â”€ (N) haccp_plan
haccp_plan (1) â”€â”€â”€â”€â”€â”€ (N) critical_control_point
critical_control_point (1) â”€â”€â”€â”€â”€â”€ (N) monitoring_record
monitoring_record (1) â”€â”€â”€â”€â”€â”€ (1) corrective_action
corrective_action (1) â”€â”€â”€â”€â”€â”€ (N) approval_log
facility (1) â”€â”€â”€â”€â”€â”€ (N) user
facility (1) â”€â”€â”€â”€â”€â”€ (N) iot_sensor
facility (1) â”€â”€â”€â”€â”€â”€ (N) equipment
facility (1) â”€â”€â”€â”€â”€â”€ (1) erp_integration
```

### 8.2 Technology Stack Summary

**Client Layer:**
- Mobile: Swift (iOS), Kotlin (Android)
- Web: React, TypeScript, TailwindCSS
- Offline: SQLite (local storage), Service Workers (PWA)

**API Gateway:**
- Node.js, Express
- JWT authentication
- Rate limiting, WAF

**Application Services (Microservices):**
- HACCP Plan Service
- Monitoring Service
- Corrective Action Service
- Reporting Service
- Integration Service
- IoT Service

**Data Layer:**
- PostgreSQL (transactional data)
- MongoDB (documents, photos)
- Redis (caching, real-time)
- S3 (object storage)

**Infrastructure:**
- Cloud: AWS/Azure
- Deployment: Docker, Kubernetes
- CDN: CloudFront/Azure CDN
- Security: WAF, DDoS protection

### 8.3 Security & Compliance

**Data Security:**
- Encryption at rest (AES-256)
- Encryption in transit (TLS 1.3)
- SOC 2 Type II compliance
- GDPR compliant
- 21 CFR Part 11 (pharmaceutical deployments)

**Access Control:**
- Role-based access control (RBAC)
- Multi-factor authentication (MFA)
- SSO support (SAML, OAuth)
- Audit logs (immutable)

**Backup & Recovery:**
- Automated daily backups
- Point-in-time recovery
- 99.9% uptime SLA
- Disaster recovery (RPO: 1 hour, RTO: 4 hours)

---

## 9. Implementation Roadmap

### Phase 1: Core HACCP Platform (Months 1-3)
- Module 1: HACCP Plan Management
- Module 2: Daily Monitoring & Data Capture
- Module 3: Corrective Action Management

### Phase 2: Reporting & Analytics (Months 4-5)
- Module 4: Audit & Reporting

### Phase 3: Scale & Integration (Months 6-8)
- Module 5: Multi-Location Management
- Module 6: Integration & IoT

### Phase 4: Administration (Month 9)
- Module 7: Administration & Settings

### Phase 5: Industry Specialization (Months 10-12)
- Food Manufacturing customizations
- Pharmaceutical 21 CFR Part 11
- Hospitality/Restaurant features

---

## 10. Success Metrics

**User Adoption:**
- Time to first HACCP plan: <45 minutes (vs. 2-6 weeks industry avg)
- Daily monitoring task completion time: <30 seconds per task
- User activation rate: 85%+ (sign-up â†’ active usage within 7 days)

**Compliance Impact:**
- Audit pass rate: 98%+ (vs. 75% industry avg)
- Corrective action resolution time: <24 hours avg
- Violation rate reduction: 40% within 6 months

**Business Metrics:**
- Customer retention: 90%+ annual
- Net Promoter Score (NPS): 50+
- Customer acquisition cost (CAC): <$500
- Lifetime value (LTV): $12,000+ (3-year avg)

**Operational Efficiency:**
- Time saved per week: 10 hours â†’ 30 minutes (95% reduction)
- Paper cost savings: $2,000-5,000/year per location
- Failed audit cost avoidance: $10,000-50,000/year

---

## 11. Competitive Differentiation Summary

**vs. SafetyChain (Enterprise Leader):**
- **Same:** Enterprise-grade features, IoT, multi-location
- **Better:** 60% lower cost, 10x faster implementation, mobile-first UX
- **Positioning:** "SafetyChain for SMBs"

**vs. FoodDocs (SMB Leader):**
- **Same:** Affordable pricing, AI HACCP builder, fast setup
- **Better:** Reliability (no bugs), enterprise reporting, multi-location support
- **Positioning:** "FoodDocs that works at scale"

**vs. ComplianceMate (Hospitality):**
- **Same:** Franchise management, POS integration
- **Better:** Better uptime, modern mobile UX, faster setup
- **Positioning:** "ComplianceMate reimagined for 2025"

**Core Value Proposition:**

> **"24-hour HACCP compliance. Zero paperwork. Zero failed audits."**
> 
> Enterprise HACCP features at SMB pricing. $99-999/month. Setup in 24 hours, not 6-12 months.

---

**END OF PRODUCT DESCRIPTION DOCUMENT**

*Document Version: 1.0*  
*Last Updated: January 1, 2026*  
*Total Features Documented: 28 across 7 modules*
